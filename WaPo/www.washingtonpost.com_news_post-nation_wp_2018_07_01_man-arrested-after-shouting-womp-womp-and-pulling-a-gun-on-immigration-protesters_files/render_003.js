(function($,window){var env=wp_pb.environment||"production";var apiURL,subscribeURL,unSubscribeURL,recentNotificationsURL;var pushNotifToken="push_notification_token";var Notifications="push_notifications";var sessionCount="push_notif_session_count";var lastModified="push_notif_lastModified";var subscribedToMMP="push_notif_subscribedMMP";var reg;var logger=new TWP.Tools.logger("dn");var Push={init:function(){var width=window.innerWidth>0?window.innerWidth:screen.width,is_chrome=navigator.userAgent.indexOf("Chrome")>
-1;if(env=="production")apiURL="https://devicereg.washingtonpost.com/";else apiURL="https://device-reg-staging.wpdigital.net/";subscribeURL=apiURL+"pushv2/register/breaking_news/DESKTOP_ALERTS/DESKTOP_CHROME?deviceToken\x3d";unSubscribeURL=apiURL+"pushv2/unregister/breaking_news/DESKTOP_ALERTS?deviceToken\x3d";recentNotificationsURL=apiURL+"pushv2/messages/recent?pushApp\x3dDESKTOP_ALERTS\x26days\x3d1";if(env=="production")recentNotificationsURL="https://device-reg.wpdigital.net/pushv2/messages/recent?pushApp\x3dDESKTOP_ALERTS\x26days\x3d1";
$(".pb-f-page-push-notifications").addClass("hide");if(is_chrome&&width>400){if(Notification.permission==="default")$(".notif-number").html("1").removeClass("hide");Push.initServiceWorker()}},initServiceWorker:function(){if("serviceWorker"in navigator){logger.log("Service Worker is supported");navigator.serviceWorker.addEventListener("message",function(event){logger.log("Push alerts updated",event.data);Push.saveInLocalStorage(event.data)});wp_pb&&wp_pb.StaticMethods&&wp_pb.StaticMethods.registerServiceWorker().then(function(){return navigator.serviceWorker.ready}).then(function(serviceWorkerRegistration){reg=
serviceWorkerRegistration;logger.log("Service Worker is ready :^)",reg);Push.requestPermission();Push.initNotifications()})["catch"](function(error){logger.log("Service Worker Error :^(",error)})}},getSubscription:function(callback){reg.pushManager.getSubscription().then(function(pushSubscription){if(pushSubscription==null)reg.pushManager.subscribe({userVisibleOnly:true}).then(function(pushSubscription){var x=pushSubscription.endpoint.split("/");token=x[x.length-1];window.localStorage.setItem(pushNotifToken,
token);Push.subscribeMMP(pushSubscription,callback)});else{var x=pushSubscription.endpoint.split("/");var token=x[x.length-1];window.localStorage.setItem(pushNotifToken,token);if(callback)callback()}})},subscribeMMP:function(subscription,callback){var userData,token,url;userData=subscription.toJSON().keys.auth;var x=subscription.endpoint.split("/");token=x[x.length-1];url=subscribeURL+token+"\x26userData\x3d"+userData;(function _subscribeMMP(){$.get(url,function(data){if(callback)callback();if(data.status==
"Registered")window.localStorage.setItem(subscribedToMMP,true);else if(data.status=="Queued"){window.localStorage.setItem(subscribedToMMP,"Queued");setTimeout(function(){_subscribeMMP()},3E4)}}).fail(function(){window.localStorage.setItem(subscribedToMMP,false);setTimeout(function(){_subscribeMMP()},3E4)})})()},unsubscribe:function(callback){reg.pushManager.getSubscription().then(function(pushSubscription){if(pushSubscription){var x=pushSubscription.endpoint.split("/");var token=x[x.length-1];(function _unsubscribeMMP(){$.get(unSubscribeURL+
token,function(){window.localStorage.removeItem(pushNotifToken);window.localStorage.removeItem(Notifications);window.localStorage.removeItem(lastModified);window.localStorage.removeItem(subscribedToMMP);pushSubscription.unsubscribe().then(function(event){logger.log("Unsubscribed!",event);if(callback)callback()})["catch"](function(error){logger.log("Error unsubscribing",error)})}).fail(function(){setTimeout(function(){_unsubscribeMMP()},3E4);window.localStorage.removeItem(pushNotifToken);window.localStorage.removeItem(Notifications);
window.localStorage.removeItem(lastModified);window.localStorage.removeItem(subscribedToMMP);$(".notifications-container .permission-request").addClass("hide");$(".notifications-container .notification-items").addClass("hide");pushSubscription.unsubscribe().then(function(event){logger.log("Unsubscribed!",event);if(callback)callback()})["catch"](function(error){logger.log("Error unsubscribing",error)});sendToScout("count","UnSubscribeResponseError",1,["env:"+env],1)})})()}else{window.localStorage.removeItem(pushNotifToken);
window.localStorage.removeItem(Notifications);window.localStorage.removeItem(lastModified);if(callback)callback()}})},getSubscriptionToken:function(){return localStorage.getItem(pushNotifToken)},_timeSince:function(date){var currentTime=(new Date).toLocaleString("en-US",{timeZone:"America/New_York"});var seconds=Math.floor((new Date(currentTime)-date)/1E3);if(seconds<3)return"just now";if(seconds<60)return Math.floor(seconds)+" seconds ago";if(seconds>180)return false;var interval=Math.floor(seconds/
3600);if(interval==1)return interval+" hour ago";if(interval>24)return false;if(interval>1)return interval+" hours ago";interval=Math.floor(seconds/60);if(interval==1)return interval+" minute ago";if(interval>1)return interval+" minutes ago";return Math.floor(seconds)+" seconds ago"},_appendItem:function(notifications){var $container=$(".notifications-container .notification-items .notifications-list");var seenCount=0,itemAdded=false;if(window.localStorage.getItem(subscribedToMMP)=="false"){$container.html("\x3cp class\x3d'empty-notification-txt'\x3eNotifications are not currently available.\x3c/p\x3e");
return}if(notifications&&notifications.length>0){var $list=$(document.createElement("div"));var url="";for(var i=0;i<notifications.length;i++){var data=notifications[i];var messageId=data.pushID;var time=Push._timeSince(new Date(data.datetime));if(time!==false){var $item=$(document.createElement("div"));$item.addClass("item");if(data.seen)$item.addClass("seen");else seenCount++;var $headline=$(document.createElement("a"));$headline.addClass("headline");$headline.html(data.headline);if(data.contentURL.indexOf("?")>
-1)url=data.contentURL+"\x26tidr\x3dnotifi_bell_breaking-news\x26pushid\x3d"+messageId;else url=data.contentURL+"?tidr\x3dnotifi_bell_breaking-news\x26pushid\x3d"+messageId;$headline.attr("href",url);var $tagline=$(document.createElement("p"));$tagline.addClass("tagline");$tagline.html(time);$item.append($headline);$item.append($tagline);$list.append($item);itemAdded=true}}}if(seenCount>0)$(".notif-number").html(seenCount).removeClass("hide");if(itemAdded==false)$container.html("\x3cp class\x3d'empty-notification-txt'\x3eThere are no recent notifications.\x3c/p\x3e");
else $container.html($list)},updateNotifications:function(){function performGET(){$.get(recentNotificationsURL,function(data,status,xhr){window.localStorage.setItem(lastModified,xhr.getResponseHeader("Last-Modified"));Push.saveInLocalStorage(data.DESKTOP_ALERTS)}).fail(function(){sendToScout("count","APIResponseError",1,["env:"+env],1)})}var lastModifiedData=window.localStorage.getItem(lastModified);if(lastModifiedData)$.ajax({type:"HEAD",url:recentNotificationsURL}).done(function(data,status,xhr){if(xhr.getResponseHeader("Last-Modified")!==
lastModifiedData)performGET()}).fail(function(){sendToScout("count","APIResponseError",1,["env:"+env],1)});else performGET()},saveInLocalStorage:function(notificationData){var savedData=JSON.parse(window.localStorage.getItem(Notifications));if(savedData){for(var i=0;i<notificationData.length;i++){var result=$.grep(savedData,function(e){return e.messageId==notificationData[i].messageId});if(result.length>0)notificationData[i].seen=result[0].seen}savedData=notificationData}else savedData=notificationData;
if(savedData&&savedData.length>0){window.localStorage.setItem(Notifications,JSON.stringify(savedData));Push._appendItem(savedData)}else $(".notifications-container .notifications-list").html("\x3cp class\x3d'empty-notification-txt'\x3eThere are no recent notifications.\x3c/p\x3e")},fetchNotifications:function(){var token=Push.getSubscriptionToken();if(token&&token!==""){var savedData=JSON.parse(window.localStorage.getItem(Notifications));Push.saveInLocalStorage(savedData);if(window.localStorage.getItem(subscribedToMMP)!==
"true")setTimeout(function(){reg.pushManager.getSubscription().then(function(pushSubscription){Push.subscribeMMP(pushSubscription)})},3E4)}},reqPermNativePopup:function(){setTimeout(function(){sendCustomTrackProps("notifications ask","notifi_ask")},5E3);Notification.requestPermission(function(permission){if(permission==="granted"){sendCustomTrackProps("notifications allowed","notifi_allowed");Push.getSubscription(function(){Push.fetchNotifications();Push.updateNotifications();$(".notifications-container .permission-request").addClass("hide");
$(".notify-ic").removeClass("bell-opened")})}else if(permission==="denied"){$(".notifications-container .permission-request .permission-default").addClass("hide");$(".notifications-container .permission-request .permission-denied").removeClass("hide");sendCustomTrackProps("notifications blocked","notifi_blocked")}else if(permission=="default")sendCustomTrackProps("notifications dismissed","notifi_dismissed")})},initNotifications:function(){function hideAll(scrolling){$(".notif-number, .notification-items, .permission-request").addClass("hide");
$(".notify-ic").removeClass("bell-opened");$(".notifications-list").removeClass("scrolling");if(scrolling)sendCustomTrackProps("notifications bell close scroll","notifi_bell-close-scroll");else sendCustomTrackProps("notifications bell close click","notifi_bell-close-click")}function showRequestPermission(){$(".notifications-container .permission-request").removeClass("hide");$(".notifications-container .notification-items").addClass("hide");$(".notify-ic").addClass("bell-opened")}function showNotifications(){var savedData=
JSON.parse(window.localStorage.getItem(Notifications));Push._appendItem(savedData);$(".notification-items").removeClass("hide");$(".notifications-container .permission-request").addClass("hide");$(".notify-ic").addClass("bell-opened");var h=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(h-220<$(".notifications-list").height())$(".notifications-list").addClass("scrolling");if(!$(".notif-number").hasClass("hide")){$(".notif-number").addClass("hide");if(savedData){for(var i=
0;i<savedData.length;i++)savedData[i].seen=true;window.localStorage.setItem(Notifications,JSON.stringify(savedData))}}}$(document).mouseup(function(e){var container=$(".notifications-container");if(!container.is(e.target)&&container.has(e.target).length===0&&(!$(".notification-items").hasClass("hide")||!$(".permission-request").hasClass("hide")))hideAll()});wp_pb.register("nav","finish_close",function(){if(!$(".notification-items").hasClass("hide")||!$(".permission-request").hasClass("hide"))hideAll(true)});
window.addEventListener("online",function(){var token=Push.getSubscriptionToken();if(token&&token!=="")Push.updateNotifications()});$(".notifications-container .permission-request .notify-action.yes").click(function(){if(!$.trim($(".permission-denied").html()).length){var noticeurl="/pb/api/v2/render/feature/page/push-notifications?shownotice\x3dshownotice";$.get(noticeurl,function(data){var rootEl=$(data.rendering);var permissionText=rootEl.find(".permission-denied-text");$("#nav-bar").find(".permission-denied").append(permissionText);
var permissionImage=rootEl.find(".permission-denied-img");$("#nav-bar").find(".permission-denied").append(permissionImage)})}sendCustomTrackProps("notifications turn on","notifi_bell-turnon");Push.reqPermNativePopup()});$(".notifications-container .turn-off").click(function(){sendCustomTrackProps("notifications turn off","notifi_bell-turnoff");Push.unsubscribe(function(){$(".notifications-container .permission-request").removeClass("hide");$(".notifications-container .notification-items").addClass("hide")});
return false});$(".notifications-container .notify-action.not-now").click(function(){hideAll()});$(".notify-ic").click(function(){if($(this).hasClass("bell-opened")){hideAll();return}if($(".pb-f-posttv-live-bar").height())$(".notifications-top-arrow").addClass("gear-bar");else $(".notifications-top-arrow").removeClass("gear-bar");sendCustomTrackProps("notifications bell open","notifi_bell-open");if(Notification.permission==="granted"){var token=Push.getSubscriptionToken();if(token&&token!=="")showNotifications();
else showRequestPermission()}else showRequestPermission()});if(Notification.permission==="granted")Push.fetchNotifications();var $headerNotifications=$(".pb-f-page-push-notifications .notifications-container").removeClass("hidden");var $betaContainer=$("#beta-container");if($betaContainer.length>0)$betaContainer.after($headerNotifications);else $(".pb-f-page-header-v2 .sign-up-buttons").after($headerNotifications)},requestPermission:function(){if(Notification.permission==="default"){var session=window.sessionStorage.getItem(sessionCount),
sessionIntVal=session?parseInt(session):0;window.sessionStorage.setItem(sessionCount,++sessionIntVal);if(sessionIntVal%3==0)Push.reqPermNativePopup(true)}}};var sendToScout=function(type,key,value,tgs,sampleRate){sampleRate=sampleRate||1;tgs=tgs||[];var message={k:"PushNotification."+key,v:value,tags:tgs,sr:sampleRate};var xmlhttp=new XMLHttpRequest;xmlhttp.open("POST","https://pharos.arcpublishing.com/scout/"+type);xmlhttp.setRequestHeader("Content-Type","application/json;charset\x3dUTF-8");xmlhttp.send(JSON.stringify(message))};
function trackProps(value){var props={pageName:window.wp_page_name,eVar1:window.wp_page_name,prop2:window.wp_subsection,eVar2:window.wp_channel,prop3:window.wp_content_type,eVar17:window.wp_content_type};props.eVar26=value;return props}function sendCustomTrackProps(name,value){if(window.s)window.s.sendDataToOmniture(name,"event80",trackProps(value),{wait:true})}})(jQuery,window);
(function($){var feature={initBetaOptInOutButton:function(){var headerEl=document.getElementById("wp-header"),forceEligible=!!document.location.search.match(/[?&]betaOptInStatus[=$&]/),forceOptedIn=!!document.location.search.match(/[?&]betaOptInStatus=true[$&]/),okToShowBetaOptInButton=forceEligible||(headerEl?headerEl.getAttribute("data-beta-btn")=="true":false);if(okToShowBetaOptInButton)headerEl.setAttribute("data-beta-btn","true");function _init(){if(_isEligible()){_insertButton(_isOptedIn());
_setUpClickHandler()}}function _isEligible(){if(forceEligible)return true;else return okToShowBetaOptInButton&&!!document.cookie.match("NWSRDRBTEL:")}function _setUpClickHandler(){$("body").on("click",function(ev){if($(ev.target).closest("#beta-container").length==0)$("#beta-container input[type\x3dcheckbox]:checked").trigger("click")})}function _isOptedIn(){if(forceEligible)return forceOptedIn;else return okToShowBetaOptInButton&&_isEligible()&&!!document.cookie.match("NWSRDRBT:")}function _getForceFlyoutOpen(){if(wp_pb.StaticMethods.isLocalStorageAccessible()&&
localStorage.getItem("forceNewsreaderFlyoutOpen")=="true"){localStorage.removeItem("forceNewsreaderFlyoutOpen");return true}else return false}function _insertButton(isOptedIn){var el=document.querySelector("#main-navigation-right .sign-up-buttons");if(el!=null)el.insertAdjacentHTML("afterend",_getHtml(isOptedIn,_getForceFlyoutOpen()))}function _getHtml(isOptedIn,forceFlyoutOpen){var checkedAttr=forceFlyoutOpen?' checked\x3d"checked"':"";var openingHtml='\x3cdiv id\x3d"beta-container"\x3e\x3cinput type\x3d"checkbox" id\x3d"beta-cbx" class\x3d"hidden"'+
checkedAttr+'\x3e\x3clabel for\x3d"beta-cbx" class\x3d"btn"\x3e\x3cspan class\x3d"fa fa-beta icon"\x3e\x3c/span\x3e\x3cspan class\x3d"text"\x3eBETA\x3c/span\x3e\x3c/label\x3e\x3cdiv class\x3d"flyout"\x3e\x3cdiv class\x3d"flyout-top-arrow"\x3e\x3c/div\x3e\x3cdiv class\x3d"flyout-msg"\x3e';var flyoutHtml="";switch(isOptedIn){case false:flyoutHtml='You will no longer be presented with our new article experience. If you decide to give it another try, please \x3ca href\x3d"javascript:void( TWP.newsreader._optIn() )"\x3eopt-in\x3c/a\x3e again.';
break;default:flyoutHtml='\x3cdiv class\x3d"flyout-header"\x3eWelcome to our new reading experience.\x3c/div\x3e Thank you for trying out our new article format. It\u2019s still in development, so we\u2019d \x3ca href\x3d"https://helpcenter.washingtonpost.com/hc/en-us/requests/new?ticket_form_id\x3d360000023891"\x3elove your feedback\x3c/a\x3e. If you no longer wish to participate, you can opt out \x3ca href\x3d"javascript:void( TWP.newsreader._optOut() )"\x3ehere\x3c/a\x3e.';break}var closingHtml=
"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";return openingHtml+flyoutHtml+closingHtml}_init()},init:function(){this.initBetaOptInOutButton()}};feature.init()})(jQuery);
(function(){__e=window.__e||[];var $w=$(window),logger=!!window.TWP&&!!TWP.Tools&&!!TWP.Tools.logger?new TWP.Tools.logger("pb-f-sharebars-top-share-bar"):window.console;try{var socialTools={myRoot:".top-sharebar-wrapper",init:function(){$(".pb-f-sharebars-top-share-bar").each(function(index,root){if(!wp_pb.BrowserInfo.desktop&&!$(root).find(".top-sharebar-wrapper").data("pb-prevent-ajax")&&$(root).find(".vertical-sticky-top-sharebar").length==0){var contentUriPath=$(root).find(".top-sharebar-wrapper").data("pb-canonical-url");
if(contentUriPath.indexOf(".washingtonpost.com")>=0)$.ajax({url:"/pb/api/v2/render/feature",dataType:"json",data:{id:$(root)[0].id,uri:window.location.pathname,contentUri:contentUriPath,desktop:wp_pb.BrowserInfo.desktop,mobile:wp_pb.BrowserInfo.mobile},cache:true,jsonCallback:"wpTopShareBarAjax",success:function(data){$(root).empty();$(root).append($(data.rendering).children());socialTools.originalInit()},error:function(data){socialTools.originalInit()}});else socialTools.originalInit();$(root).find(".top-sharebar-wrapper").data("pb-prevent-ajax",
"true")}else socialTools.originalInit()})},originalInit:function(myRoot){var self=this;myRoot=myRoot||this.myRoot;$myRoot=$(myRoot);if($myRoot.hasClass("sticky-top-sharebar"))stickyHorizontalShareBar.init();$myRoot.each(function(index,myRootElement){if($(myRootElement).hasClass("vertical-sticky-top-sharebar"))stickyVerticalShareBar.init($(myRootElement));var $root=$(myRootElement),$individualTool=$(".tool:not(.more, .read-later-bookmark, .read-later-list)",$root),$socialToolsWrapper=$(".social-tools-wrapper",
$root),$socialToolsMoreBtn=$(".tool.more",$socialToolsWrapper),$socialToolsAdditional=$(".social-tools-additional",$root),width=window.innerWidth>0?window.innerWidth:screen.width,isMobile=mobile_browser===1&&width<480?true:false;$socialToolsMoreBtn.off("click").on("click",this,function(ev){$socialToolsMoreBtn.hide();$socialToolsAdditional.show("fast",function(ev){$root.addClass("expanded");$(".social-tools",$socialToolsAdditional).animate({"margin-left":0},4250)}).addClass("more-open")});$individualTool.off("click");
$individualTool.on({click:function(event){var shareType=$(this).attr("class");var eVar1=$(this).data("evar1");shareType=typeof shareType!="undefined"?shareType.split(" ")[0].trim():"";self.trackTraffic("share."+shareType,shareType+"_bar",eVar1)}});if(wp_pb&&wp_pb.BrowserInfo&&wp_pb.BrowserInfo.tablet)$root.addClass("tablet");if(wp_pb.BrowserInfo.mobile&&$root.find(".vertical-sticky-top-sharebar").length>0){var calcMobileIcons=function(){var width=$root.find(".social-tools-wrapper").width()-5;var shareIconWidth=
Math.ceil($root.find(".social-tools-primary .social-tools .tool").first().outerWidth(true));$root.find(".social-tools-primary .social-tools .tool.more").hide();var allShare=$root.find(".social-tools-primary .social-tools .tool:not(.more), .social-tools-additional .social-tools .tool").hide();if($root.find(".social-tools-readlater").length>0)width=width-Math.ceil($root.find(".social-tools-readlater").width());var numShare=Math.floor(width/shareIconWidth);for(var share=0;share<allShare.length;share++)try{if(share<
numShare)$(allShare.get(share)).fadeIn();else $(allShare.get(share)).hide()}catch(e){}};$(window).resize(function(){calcMobileIcons()});calcMobileIcons()}else $root.find(".social-tools-primary .social-tools .tool").fadeIn();$root.removeClass("unprocessed")});if(typeof wp_pb.StaticMethods.initReadLater=="function")wp_pb.StaticMethods.initReadLater($myRoot,"top-share-bar")},trackTraffic:function(name,eVar27,eVar1){if(typeof window.sendDataToOmniture==="function"){var omnitureVars={eVar1:typeof eVar1!=
"undefined"?eVar1:typeof window.s=="object"&&s&&s.eVar1,eVar2:typeof window.s=="object"&&s&&s.eVar2,eVar8:typeof window.s=="object"&&s&&s.eVar8,eVar17:typeof window.s=="object"&&s&&s.eVar17,eVar27:eVar27};try{sendDataToOmniture(name,"event6",omnitureVars)}catch(e){}}},getSnowflake:function(){var currentSnowflake=TWP.Analytics&&TWP.Analytics.Snowflake?TWP.Analytics.Snowflake.getCurrent():{};return currentSnowflake.outgoing||""}};var stickyVerticalShareBar={init:function($myRoot){if($("#article-full-width-content").length===
0)$myRoot.closest(".pb-f-sharebars-top-share-bar").insertBefore("#pb-root");if(window.innerWidth>992){$myRoot.css({top:($w.height()-$myRoot.outerHeight()+25)/2+"px"});$myRoot.animate({left:"-1px"});$w.resize(function(){$myRoot.animate({top:($w.height()-$myRoot.outerHeight()+25)/2+"px"},50)})}stickyVerticalShareBar.enableCollisionDetection($myRoot);wp_pb.register("sticky-vertical-sharebar","collides_with_main_content",function(collides){$myRoot.closest(".pb-f-sharebars-top-share-bar").css("opacity",
collides?"0":"").css("pointer-events",collides?"none":"inherit")});wp_pb.register("magnet","start_open",function(){$myRoot.animate({top:($w.height()-$myRoot.outerHeight()+$(".pb-f-page-magnet .pb-module-area").height()+25)/2+"px"},50)});wp_pb.register("magnet","start_close",function(){$myRoot.animate({top:($w.height()-$myRoot.outerHeight()+25)/2+"px"},50)});wp_pb.register("nav","menu_start_open",function(){$myRoot.hide();$myRoot.css("left","-"+$myRoot.outerWidth()+"px")});wp_pb.register("nav","menu_finish_close",
function(){if(window.innerWidth>992)setTimeout(function(){$myRoot.show();$myRoot.animate({left:"-1px"})},100)})},enableCollisionDetection:function(supported){var INTERVAL_MS=600;var MAX_INTERVALS=3;var intervalCount=0;return function($myRoot){var job;if(!supported||intervalCount>MAX_INTERVALS)return;job=setInterval(function(){var $sb=$myRoot.closest(".pb-f-sharebars-top-share-bar");var $sbw=$sb.find(".top-sharebar-wrapper");var $mc=$("html").hasClass("gallery_story")?$(".pb-f-gallery-gallery"):$("#main-content");
var oldcollides=$sb.data("__mccollides");var newcollides={value:undefined};if(!$sb.length||!$sbw.length||!$mc.length)clearInterval(job);else{newcollides.value=collision($mc[0],$sbw[0]);if(!oldcollides||newcollides.value!==oldcollides.value){wp_pb.report("sticky-vertical-sharebar","collides_with_main_content",newcollides.value);$sb.data("__mccollides",{value:newcollides.value})}}},INTERVAL_MS);intervalCount++;function collision(element1,element2){var rect1=element1.getBoundingClientRect(),rect2=element2.getBoundingClientRect();
return!(rect1.top>rect2.bottom||rect1.right<rect2.left||rect1.bottom<rect2.top||rect1.left>rect2.right)}}}("getBoundingClientRect"in document.documentElement)};var stickyHorizontalShareBar={setElmTop:function($sharebarElm,y){var style=y?"translate3d(0px, "+y+"px, 0px)":"initial";$sharebarElm.css({transform:style})},navMenuToggle:function($sharebarElm){wp_pb.register("nav","finish_open",function(){this.setElmTop($sharebarElm,0)},this);wp_pb.register("nav","finish_close",function(){this.setElmTop($sharebarElm,
-50)},this);wp_pb.register("magnet","start_open",function(){},this)},fixedPosition:function($sharebarElm,sharebarTop){var currentTop=$w.scrollTop();if(currentTop>sharebarTop){if(!$sharebarElm.hasClass("top-sharebar-fixed")){$sharebarElm.addClass("top-sharebar-fixed");wp_pb.report("sticky-top-sharebar","sharebar_fixed",true)}}else{$sharebarElm.removeClass("top-sharebar-fixed");wp_pb.report("sticky-top-sharebar","sharebar_unfixed",true)}},moveOutOfRoot:function($sharebarElm){var $pbRoot=$("#pb-root");
if($pbRoot.css("max-width")!=="none"){var $sharebarRoot=$sharebarElm.parent();var $leaderboard=$(".pb-f-ad-leaderboard");$sharebarRoot.find(".sticky-top-sharebar").css("padding-top","55px");$pbRoot.before($sharebarRoot);$pbRoot.before($leaderboard)}},detectMobileForSMS:function(){if(mobile_browser){var shareString="";if(windows_browser)shareString="sms://?body\x3d";else if(android_browser||android233_browser)shareString="sms:?body\x3d";if(shareString.length>0)$(".pb-f-sharebars-top-share-bar .sms-share-device.unprocessed").each(function(){$(this).attr("onclick",
$(this).attr("onclick").replace(/sms:\?&body=/g,shareString));$(this).removeClass("unprocessed")});else $(".pb-f-sharebars-top-share-bar .sms-share-device.unprocessed").removeClass("unprocessed")}},init:function(){var $sharebarElm=$(".sticky-top-sharebar"),self=this;if(!$sharebarElm.length)return;this.moveOutOfRoot($sharebarElm);var sharebarTop=$sharebarElm.offset().top;var $header=$("#wp-header");if($header.css("position")==="fixed"&&$w.scrollTop()>sharebarTop)this.fixedPosition($sharebarElm,sharebarTop);
$w.off("scroll.sharebar").on("scroll.sharebar",function(){self.fixedPosition($sharebarElm,sharebarTop)});$(function(){self.navMenuToggle($sharebarElm)});this.detectMobileForSMS()}};var userId=document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:"";var userSecureId=document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:"";var userAgent=navigator.userAgent;var textResizer={currIncrementMax:9,currIncrementUnit:2,currIncrementIndex:0,init:function(myRoot,resizeableElementList,clickElement){myRoot=
myRoot||"#article-body article, .related-story, .liveblog-intro, #liveblog-story-list .description, #full-recipe .article-content";resizeableElementList=resizeableElementList||"p, li";clickElement=clickElement||".tool.textresizer";this.root=$(myRoot);this.resizeableElements=$(resizeableElementList,this.root);if($(".related-story").prev("h3").length>0){this.resizeableElements.push($(".related-story").prev("h3"));this.resizeableElements.push($(".related-story h4 a"))}$(clickElement).on("click",this,
this.resize)},resize:function(event){var currObj=event.data;if(currObj.currIncrementIndex==currObj.currIncrementMax){currObj.currIncrementIndex=0;currObj.currIncrementUnit=currObj.currIncrementUnit==2?-2:2}currObj.currIncrementIndex=currObj.currIncrementIndex+1;currObj.resizeableElements.each(function(){elm=$(this);currSize=parseFloat(elm.css("font-size"),5);var result=currSize+currObj.currIncrementUnit;elm.css("font-size",result);wp_pb.report("textresizer","resized",result)})}};var trackTraffic=
function(name){if(typeof window.sendDataToOmniture==="function"){var omnitureVars={eVar1:typeof window.s=="object"&&s&&s.eVar1,eVar2:typeof window.s=="object"&&s&&s.eVar2,eVar8:typeof window.s=="object"&&s&&s.eVar8,eVar17:typeof window.s=="object"&&s&&s.eVar17,eVar27:name};try{sendDataToOmniture(name+".click","event6",omnitureVars)}catch(e){}}};var lifecycle={init:function(){$(".social-tools-wrapper .tool.textresizer, .social-tools-wrapper .tool.print").on("click",function(){var name=$(this).attr("class").split(" ")[0].trim();
trackTraffic(name)});window.TWP=TWP||{};TWP.SocialTools=TWP.SocialTools||socialTools;TWP.SocialTools.init();TWP.TextResizer=TWP.TextResizer||textResizer;TWP.TextResizer.init();if($(".tool.comments")){var commentSystem=$(".tool.comments .coral-counter").length>0?"coral":"echo";wp_pb.report("comment_count_target","init",{targetName:"#share_comment_count",targetUrl:$("#share_comment_count").attr("guid"),commentSystem:commentSystem})}var tablet=isMobile.tablet();if(!!window.VisitorSegment)window.VisitorSegment&&
VisitorSegment("tablet",function(){return tablet&&$w.width()>768})}};if(wp_pb.StaticMethods.isPageHydrated())lifecycle.init();__e.push(["shamble",function(){lifecycle.init()}])}catch(err){logger.error(err)}})();
(function($,TWP,undefined){var AD_LOAD_TIMER=2E3;var AD_MIN_VISIBLE=4E3;var AD_HEIGHT_LIMITED=150;var ANIM_SPEED=250;var console=new TWP.Tools.logger("leaderboard");if($(".layout_article #pb-root .pb-f-ad-leaderboard.full").length)var $leaderboard=$(".pb-f-ad-leaderboard");var applyStickiness=function(){var isLoginUser=document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:"";if(wp_pb.BrowserInfo&&wp_pb.BrowserInfo.tablet||isLoginUser)return;$(function(){var $html=$("html"),$feature=getFeature().find(".leaderboard"),
$window=$(window),timer,slotId="slug_leaderboard",$slotAd=$feature.find("#"+slotId),$closeBtn=$feature.find(".leaderboard-close");if(!$feature.length)return;function removeSticky(){setTimeout(function(){console.log("remove sticky leaderboard.");$feature.slideUp(ANIM_SPEED,function(){$html.removeClass("lb-persist-top-true");$feature.slideDown(ANIM_SPEED)})},AD_MIN_VISIBLE)}function applySticky(){if($window.scrollTop()>100)$html.addClass("lb-persist-top-true");else $html.removeClass("lb-persist-top-true")}
function bindEvents(){$window.on("scroll.lb-sticky",function(e){e.stopPropagation();applySticky();var bnbHeight=$(".pb-f-page-breaking-news-bar .breaking-news-bar").outerHeight();if(bnbHeight>0){$feature.addClass("pb-has-breaking-news");$feature.css("margin-top",bnbHeight+"px");wp_pb.register("breakingnews","close",function(){$feature.removeClass("pb-has-breaking-news");$feature.css("margin-top","")})}});wp_pb.register("nav","finish_open",function(){$feature.removeClass("pb-navheader-hidden")});wp_pb.register("nav",
"finish_close",function(){$feature.addClass("pb-navheader-hidden")});$closeBtn.on("click.lb-sticky",function(e){AD_MIN_VISIBLE=0;afterLoaded();if(typeof window.sendDataToOmniture==="function"){var data={pageName:window.wp_page_name,eVar1:window.wp_page_name,prop2:window.wp_subsection,eVar2:window.wp_channel,prop3:window.wp_content_type,eVar17:window.wp_content_type,eVar26:"leaderboard-close"};sendDataToOmniture("leaderboard-close","event80",data)}})}function afterLoaded(){var $featureContainer=getFeature();
if($feature.height()>$featureContainer.outerHeight())$featureContainer.height($feature.height()+30);$feature.addClass("leaderboard-ad-loaded");$window.off("scroll.lb-sticky");if($html.hasClass("lb-persist-top-true"))removeSticky()}function afterAdInserted(){timer=setTimeout(function(){console.log("from second timeout: prevent ad load fail.");afterLoaded()},6E3);if(window.googletag&&googletag.pubadsReady)googletag.pubads().addEventListener("slotRenderEnded",function(event){console.log("ad slot: "+
event.slot.getSlotElementId()+" inserted success");if(event.slot.getSlotElementId()===slotId){clearTimeout(timer);setTimeout(function(){console.log("leaderboard ad load success.");afterLoaded()},AD_LOAD_TIMER)}})}applySticky();bindEvents();setTimeout(function(){$closeBtn.addClass("fa-remove")},6E3);if($slotAd.children().length)timer=setTimeout(function(){console.log("from first timeout: if ad is already loaded");afterLoaded()},AD_LOAD_TIMER);$feature.on("DOMNodeInserted",function(e){var $el=$(e.target),
id=$el.attr("id");if($el.is("iframe")&&id&&!/(hidden)/g.test(id)){clearTimeout(timer);$feature.off("DOMNodeInserted");afterAdInserted()}});$feature.on("disableSticky.lb-sticky",function(e){clearTimeout(timer);$window.off("scroll.lb-sticky");$feature.off("DOMNodeInserted");$html.removeClass("lb-persist-top-true");TWP.Features.Ad.Leaderboard.sticky=false})})};if(!!TWP.Features.Ad.Leaderboard.sticky)applyStickiness();if(!!TWP.Features.Ad.Leaderboard.belowSharebar)applySharebarPosition();$(window.document).on("abtest-ready",
function(e,ABT){var test=ABT.get("ads-leaderboard");getFeature().attr("moat-test-id",[getFeature().attr("moat-id")||"unknown/unknown",test.name||"control"].join("-"));if(test.is("below_sharebar"))applySharebarPosition();if(test.is("sticky"))applyStickiness()});function applySharebarPosition(){var $leaderboard=getFeature();var $shareBar=getSharebar();$leaderboard.addClass("after-sharebar-leaderboard");return $leaderboard.insertAfter($shareBar)}function getFeature(){return $(".pb-f-ad-leaderboard")}
function getSharebar(){return $(".pb-f-sharebars-top-share-bar")}})(jQuery,TWP);
(function($){__e=window.__e||[];try{var $d=$(document),$w=$(window),logger=!!window.TWP&&!!TWP.Tools&&!!TWP.Tools.logger?new TWP.Tools.logger("pb-f-article-article-topper"):window.console;var feature={remarryHeadlines:function(){var self=this;var remarryHeadlinesSelector=".pb-f-article-article-topper h1, .pb-f-article-ans-article-topper h1";try{wp_pb.StaticMethods.remarryHeadline(remarryHeadlinesSelector)}catch(e){}},initTiffanyTile:function(){logger.log("initTiffanyTile");var tiffanyTile=$("#article-topper #slug_tiffany_tile");
logger.log(tiffanyTile.is("visible"));if(tiffanyTile.length&&(tiffanyTile.is("visible")||!tiffanyTile.is(":hidden"))){$("#topper-headline-wrapper").addClass("col-sm-8").removeClass("col-sm-12");$("#topper-headline-wrapper").addClass("col-lg-9").removeClass("col-lg-12")}else $d.ready(function(){if(window.googletag&&googletag.cmd)googletag.cmd.push(function(){var slotId="tiffany_tile";googletag.pubads().addEventListener("slotRenderEnded",function(event){if(event.slot.getSlotElementId().indexOf(slotId)>
0){logger.log("initTiffanyTile rendered end");if(event.slot.j._empty_===false||$("#article-topper #slug_tiffany_tile").is("visible")||!$("#article-topper #slug_tiffany_tile").is(":hidden")){$("#topper-headline-wrapper").addClass("col-sm-8").removeClass("col-sm-12");$("#topper-headline-wrapper").addClass("col-lg-9").removeClass("col-lg-12")}}})})})},initAlignToggle:function(){var self=this;if($(".header-tool")!==undefined&&$(".header-tool").length>0)if($(".header-tool").position().left==0)$(".header-tool").css("margin-left",
"0");else $(".header-tool").css("margin-left","30px")},initLanguageDivs:function(){var self=this;var langdivs=$('span[id^\x3d"translate-text-"]').hide(),divi=0;(function cycle(){langdivs.eq(divi).fadeIn("slow").delay(3E3).fadeOut("slow",cycle);divi=++divi%langdivs.length})()},initLanguageToggle:function(){var self=this;var $toggleOption=$(".header-wp-language-button");$toggleOption.click(function(e){var $this=$(".header-lang-dropdown");if($this.hasClass("wp-language-button-clicked")){$this.removeClass("wp-language-button-clicked");
$toggleOption.removeClass("wp-language-button-clicked-wrapper");$(".header-tool").removeClass("header-tool-selected")}else{$this.addClass("wp-language-button-clicked");$toggleOption.addClass("wp-language-button-clicked-wrapper");$(".header-tool").addClass("header-tool-selected")}});$d.click(function(e){var target=e.target;if(!$(target).is(".header-wp-language-button")&&!$(target).parents().is(".header-wp-language-button")){$(".header-lang-dropdown").removeClass("wp-language-button-clicked");$(".header-wp-language-button").removeClass("wp-language-button-clicked-wrapper");
$(".header-tool").removeClass("header-tool-selected")}})},initFollow:function(){var self=this;var userId=document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:"",userSecureId=document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:"",userAgent=navigator.userAgent;var follow={init:function(){var userSignedIn=userId!==""?true:false,userApiUrl="",jsonData={},getUserData=true,followed=[];$("#subtitle-follow").removeClass("hide");if(userSignedIn){userApiUrl="https://follow.washingtonpost.com/Follow/api/user";
jsonData={washPostId:userId,wapoLoginID:userId,wapoSecureID:userSecureId,userAgent:userAgent}}else if(follow.localStorageAvailable()&&localStorage.getItem("wp_follow_modal_email")){userApiUrl="https://follow.washingtonpost.com/Follow/api/anonymous-user";jsonData={emailId:localStorage.getItem("wp_follow_modal_email")}}else getUserData=false;if(getUserData)$.ajax({type:"POST",url:userApiUrl,contentType:"application/json",dataType:"json",data:JSON.stringify(jsonData),success:function(data){if(follow.localStorageAvailable()&&
data.emailId)localStorage.setItem("wp_follow_modal_email",data.emailId);if(data.tags)for(var i=0,len=data.tags.length;i<len;i++)if(data.tags[i].type==="category")followed.push(data.tags[i].slug);if(followed.indexOf($("#subtitle-follow").data("categorySlug"))>=0){$("#subtitle-follow").addClass("following");$("#subtitle-follow .followLbl").text("Following")}}});$("#subtitle-follow").on("click",function(){var $this=$(this);var endpoint=$this.hasClass("following")?"unfollow":"follow",categorySlug=$this.data("categorySlug"),
categoryTitle=$this.data("categoryTitle"),position={};position.top=35;position.left=485;function applyCallBack(data){if(endpoint==="follow")$this.addClass("following").find(".followLbl").text("Following");else $this.removeClass("following").find(".followLbl").text("Follow");if(endpoint==="follow")s.sendDataToOmniture("Follow","event103",{eVar1:s.eVar1,eVar2:s.eVar2,eVar26:"fl_top_topic_"+categorySlug.replace(/-/g,"")});else s.sendDataToOmniture("Unfollow","event104",{eVar1:s.eVar1,eVar2:s.eVar2,eVar26:"fl_top_topic_"+
categorySlug.replace(/-/g,"")})}var data={categorySlug:categorySlug,categoryTitle:categoryTitle,signedIn:userSignedIn,endpoint:endpoint,callBack:applyCallBack};if(endpoint==="follow"){data.position=position;if(follow.localStorageAvailable()&&(localStorage.getItem("wp_follow_modal_seen")!=="true"||!localStorage.getItem("wp_follow_modal_email"))){var tagData={"tag":{"slug":categorySlug,"type":"category"}};$.ajax({type:"POST",url:"https://follow.washingtonpost.com/Follow/api/tag",contentType:"application/json",
dataType:"json",data:JSON.stringify(tagData),success:function(result){data.categoryDesc=result.tag.description;follow.displayPip(data)},error:function(reason){follow.displayPip(data)}})}else{data.email=follow.localStorageAvailable()?localStorage.getItem("wp_follow_modal_email"):"";follow.followApi(data)}}else follow.unfollowApi(data);return false});if(typeof Hammer==="function"&&wp_pb.BrowserInfo.mobile_browser)try{var hammertime=new Hammer($("#subtitle-follow")[0],{prevent_mouseevents:true});hammertime.on("tap",
handleTap)}catch(err){}function handleTap(ev){ev.gesture.preventDefault();ev.gesture.stopPropagation();$(ev.gesture.target).click();$(ev.gesture.target).blur()}},displayPip:function(data){var modal=$(".subTitle-follow-modal");if(data.signedIn===false){modal.find(".not-signed-In.before").removeClass("hide");modal.find(".not-signed-In.after").addClass("hide");modal.find(".signed-In").addClass("hide");if(follow.localStorageAvailable()&&localStorage.getItem("wp_follow_modal_email"))modal.find("#follow-modal-input").val(localStorage.getItem("wp_follow_modal_email"))}else{modal.find(".not-signed-In").addClass("hide");
modal.find(".signed-In").removeClass("hide");data.position.top+=20}modal.find(".category-desc").text(data.categoryDesc?data.categoryDesc:"");modal.css("top",data.position.top);modal.css("left",data.position.left);modal.jqm({overlayClass:"article-topper-follow-modal",overlay:0,onHide:function(hash){modal.find(".sign-up").off("click");modal.find(".follow-modal-close").off("click");modal.find(".got-it").off("click");hash.w.hide()&&hash.o&&hash.o.remove();return true}});modal.find(".sign-up").click(function(){var email=
modal.find("#follow-modal-input").val();var re=/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm;if(email==""||!re.test(email))$(".invalid-email").show();else{$(".invalid-email").hide();data.email=email;if(follow.localStorageAvailable())localStorage.setItem("wp_follow_modal_email",email);follow.followApi(data,function(){modal.find(".not-signed-In.before").addClass("hide");modal.find(".not-signed-In.after").removeClass("hide")})}});modal.find(".follow-modal-close").click(function(){modal.jqmHide()});modal.find(".got-it").click(function(){modal.jqmHide()});
if(data.signedIn)follow.followApi(data,function(){if(follow.localStorageAvailable()&&localStorage.getItem("wp_follow_modal_seen")!=="true"){modal.jqmShow();localStorage.setItem("wp_follow_modal_seen","true")}else modal.jqmShow()});else if(follow.localStorageAvailable()&&(localStorage.getItem("wp_follow_modal_seen")!=="true"||!localStorage.getItem("wp_follow_modal_email"))){modal.jqmShow();s.sendDataToOmniture("Follow","event101",{eVar1:s.eVar1,eVar2:s.eVar2,eVar26:"fl_top_topic_"+data.categorySlug.replace(/-/g,
"")});localStorage.setItem("wp_follow_modal_seen","true")}else{if(follow.localStorageAvailable())data.email=localStorage.getItem("wp_follow_modal_email");follow.followApi(data)}},followApi:function(data,callBack){var serviceBase="https://follow.washingtonpost.com",jsonData={washPostId:userId,tags:[]};if(data.email&&data.signedIn==false){serviceBase+="/Follow/api/anonymous-follow";jsonData.emailId=data.email;jsonData.tags=[{slug:data.categorySlug,type:"category"}]}else{serviceBase+="/Follow/api/follow";
jsonData.tags=[{slug:data.categorySlug,title:data.categoryTitle,level:1,type:"category"}]}$.ajax({type:"POST",url:serviceBase,contentType:"application/json",dataType:"json",data:JSON.stringify(jsonData),success:function(result){if(result.status==true){data.callBack(data);if(callBack)callBack()}}})},unfollowApi:function(data){var serviceBase="https://follow.washingtonpost.com";var tags=[{slug:data.categorySlug,title:data.categoryTitle,level:1,type:"category"}];var jsonData={washPostId:userId,wapoLoginID:userId,
wapoSecureID:userSecureId,userAgent:userAgent,tags:tags};if(data.signedIn)serviceBase+="/Follow/api/unfollow";else{serviceBase+="/Follow/api/anonymous-unfollow";jsonData.emailId=localStorage.getItem("wp_follow_modal_email")}$.ajax({type:"POST",url:serviceBase,contentType:"application/json",dataType:"json",data:JSON.stringify(jsonData),success:function(responce){if(responce.status==true&&data.callBack)data.callBack(responce)}})},localStorageAvailable:function(){var test="test";try{localStorage.setItem(test,
test);localStorage.removeItem(test);return true}catch(e){return false}}};$w.on("abtest-ready",function(e,ABT){var test=ABT.get("follow-powerPostTop");if(test.is("sharebar"))return;else follow.init()})},initStoryLabelModal:function(){var modal=$(".story-label-explainer");if(modal.find(".label-title").hasClass("Perspective"))modal.find(".label-content").text("Discussion of news topics with a point of view, including narratives by individuals regarding their own experiences");else if(modal.find(".label-title").hasClass("Analysis"))modal.find(".label-content").text("Interpretation of the news based on evidence, including data, as well as anticipating how events might unfold based on past events");
else if(modal.find(".label-title").hasClass("Opinion"))modal.find(".label-content").text("A column or article in the Opinions section (in print, this is known as the Editorial Pages).");else if(modal.find(".label-title").hasClass("Review"))modal.find(".label-content").text("A professional critic\u2019s assessment of a service, product, performance, or artistic or literary work");modal.jqm({overlayClass:"story-label-explainer",overlay:0,onHide:function(hash){hash.w.hide()&&hash.o&&hash.o.remove();
return true}});modal.find(".label-modal-close").click(function(){modal.jqmHide()});$(".section-label-span").hover(function(){modal.jqmShow()});$(document).mouseup(function(e){var container=$(".story-label-explainer");if(!container.is(e.target)&&container.has(e.target).length===0)modal.jqmHide()});if(typeof Hammer==="function"&&wp_pb.BrowserInfo.mobile_browser)try{var hammertime=new Hammer($(".section-label-span")[0],{prevent_mouseevents:true});hammertime.on("tap",handleTap)}catch(err){}function handleTap(ev){ev.gesture.preventDefault();
ev.gesture.stopPropagation();modal.jqmShow()}},initEssentials:function(){var self=this;var tablet=isMobile.tablet();window.VisitorSegment&&VisitorSegment("tablet",function(){return tablet&&$(window).width()>768});window._essentials_onrender=function(Essentials){var $target=$("#essentials-topper"),name=Essentials.name,data=Essentials.data,pdata=Essentials.getPersistentData(),status=pdata[Essentials.contentPath],count=!!name&&!!data?data.results.length:undefined,tcount;if(!!Essentials.name&&$(".cf-essentials-module").length!=
0){$target.show();$(function(){if(count){switch(count){case 1:tcount="One";break;case 2:tcount="Two";break;case 3:tcount="Three";break;case 4:tcount="Four";break;case 5:tcount="Five";break;default:tcount="";break}$(('\x3ch2\x3e\x3cspan class\x3d"status vg-check status-icon status-%s"\x3e\x3c/span\x3e '+'\x3cspan class\x3d"status-count"\x3e'+tcount+" Essentials\x3c/span\x3e "+'\x3cspan class\x3d"status-kicker"\x3e%k\x3c/span\x3e'+"\x3c/h2\x3e").replace("%s","undefined"==typeof status?"scroll":"read").replace("%k",
data.kicker.text)).appendTo($target);$target.on("click.essentials-topper",function(e){wp_pb.report("essentials-topper","click",{$target:$target});wp_pb.report("essentials","scrollto",{$from:$target})})}})}}},init:function(){var self=this;this.initTiffanyTile();this.initAlignToggle();this.initLanguageDivs();this.initLanguageToggle();this.initStoryLabelModal();this.initEssentials()}};if(wp_pb.StaticMethods.isPageHydrated())feature.init();__e.push(["shamble",function(){feature.init()}]);$w.on("resize",
wp_pb.StaticMethods.debounce(function(ev){feature.initAlignToggle()},25))}catch(err){}})(jQuery);(function($){})(jQuery);
(function($){__e=window.__e||[];_dw=window._dw||[];var $article,$d=$(document),$w=$(window),isDesktop=wp_pb.BrowserInfo.desktop;window.cr_on=false;var feature={initLoadTime:function(){var sel=".pb-loadtime .loadtime."+(isDesktop?"active-on-desktop":"active-on-mobile");$(sel,$article).each(function(){var $this=$(this),$parent=$this.parent(),threshold=(!isNaN($this.attr("data-threshold"))?$this.attr("data-threshold"):2)*1E3;if(!!window.history&&!!history.state&&!!history.state.loadTime){$this.html(Math.round(history.state.loadTime/
10)/100);if(history.state.loadTime<threshold)$parent.show();else $parent.hide()}})},tryInitLoadTime:function(){var sel=".pb-loadtime .loadtime."+(isDesktop?"active-on-desktop":"active-on-mobile");if($(sel,$article).filter(":empty").length>0)this.initLoadTime()},initIframes:function(){$("iframe[data-src]",$article).each(function(){var $this=$(this);$this.attr("src",$this.attr("data-src"))})},initAboutTheAuthors:function(){$("#about-the-authors").click(function(){var $this=$(this);var $container=$this.closest(".multi-author-bio");
if($container){if($container.hasClass("open"))$container.removeClass("open").addClass("closed");else $container.removeClass("closed").addClass("open");wp_pb.report("global","domChanged")}})},initTables:function(){var $tables=$("div.extra table",$article);$tables.each(function(){var $table=$(this),$bars=$(".barchart",$table),longestBar=0;$bars.each(function(){var $bar=$(this),w=$bar.attr("width");if(!isNaN(w)){w=w*1;longestBar=w>longestBar?w:longestBar}});$bars.each(function(){var $bar=$(this),w=$bar.attr("width");
if(!isNaN(w)){w=w*1;var scale=$article.width()>480?.85:.75;var relativeWidth=scale*(Math.ceil(100*(w/longestBar)*100)/100);$bar.css("width",relativeWidth+"%")}})})},initGalleries:function(){$(".pb-f-gallery-gallery, .pb-f-gallery-gallery-ans",$article).each(function(){var $gallery=$(this).children("div:first"),$gtitle=$gallery.attr("data-title"),$permalink=$gallery.attr("data-permalink"),$gurl=$permalink.indexOf("js.")>-1?$permalink.replace("js.","www."):$permalink,$genctitle=encodeURI($gtitle),$gencurl=
encodeURI($gurl),$gmain=$gallery.find(".wp-volt-gal-main"),$gheadline=$gallery.find(".wp-volt-gal-embed-promo-top"),$gpromotop=$gallery.find(".wp-volt-gal-embed-promo-top span.cell");if($gtitle&&$gurl){$gheadline.html('\x3ch3 class\x3d"promo-top-title"\x3e'+$gpromotop.html()+"\x3c/h3\x3e");var gshare='\x3cspan class\x3d"wp-article-sharing"\x3e\x3cspan class\x3d"wp-tooltip-button wp-article-embed"\x3e\x3cspan class\x3d"title"\x3eEmbed\x3c/span\x3e\x3ci class\x3d"fa fa-code icon-code"\x3e\x3c/i\x3e\x3cspan class\x3d"wp-tooltip"\x3e\x3cspan class\x3d"wp-sharing-copy"\x3e\x3cspan class\x3d"wp-sharing-copy-input-wrap"\x3e\x3cinput type\x3d"text" class\x3d"wp-sharing-copy-input" value\x3d"\x3ciframe width\x3d\'480\' height\x3d\'700\' scrolling\x3d\'no\' src\x3d\''+
$gurl+'?_template\x3dgallery-embed\' frameborder\x3d\'0\' webkitallowfullscreen mozallowfullscreen allowfullscreen\x3e\x3c/iframe\x3e"\x3e\x3c/span\x3e\x3cspan class\x3d"wp-sharing-copy-button"\x3eCopy\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"wp-tooltip-button wp-article-social"\x3e\x3cspan class\x3d"title"\x3eShare\x3c/span\x3e\x3ci class\x3d"fa fa-share icon-share-alt"\x3e\x3c/i\x3e\x3cspan class\x3d"wp-tooltip"\x3e\x3ci class\x3d"wp-sharing-button fa fa-facebook icon-facebook"\x3e\x3c/i\x3e\x3ci class\x3d"wp-sharing-button fa fa-twitter icon-twitter"\x3e\x3c/i\x3e\x3ci class\x3d"wp-sharing-button fa fa-google-plus icon-google-plus"\x3e\x3c/i\x3e\x3ca class\x3d"wp-sharing-button-email" href\x3d"mailto:?subject\x3d'+
$genctitle+" from The Washington Post\x26body\x3d"+$gencurl+'%3Ftid\x3dss_mail"\x3e\x3ci class\x3d"fa fa-envelope"\x3e\x3c/i\x3e\x3c/a\x3e\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e';$(gshare).insertAfter($gmain);var $facebook=$gallery.find(".fa-facebook");$facebook.click(function(){window.open("https://www.facebook.com/sharer/sharer.php?u\x3d"+$gencurl+"%3Ftid\x3dss_fb","share_facebook","width\x3d658,height\x3d354,scrollbars\x3dno");return false});var $twitter=$gallery.find(".fa-twitter");$twitter.click(function(){window.open("https://twitter.com/share?url\x3d"+
$gencurl+"%3Ftid\x3dss_tw\x26text\x3d"+$genctitle,"share_twitter","width\x3d550,height\x3d350,scrollbars\x3dno");return false});var $google=$gallery.find(".fa-google-plus");$google.click(function(){window.open("https://plus.google.com/share?url\x3d"+$gencurl+"%3Ftid\x3dss_gp","share_google-plus","width\x3d832,height\x3d472,scrollbars\x3dno");return false});var $copybtn=$gallery.find(".wp-sharing-copy-button");$copybtn.click(function(event){event.stopPropagation();$(event.currentTarget).parent().find(".wp-sharing-copy-input").select();
try{document.execCommand("copy")}catch(err){}})}})},initTooltips:function(){var $toggleOption=$(".wp-tooltip-button");$toggleOption.click(function(e){var $this=$(this);if($(e.target).is("span")||$(e.target).is("i.wp-sharing-button")||$(e.target).is("i.icon-envelope")||$(e.target).is("input")){e.preventDefault();return}else if($(this).hasClass("wp-tooltip-button-clicked"))$this.removeClass("wp-tooltip-button-clicked");else{$toggleOption.filter(".wp-tooltip-button-clicked").removeClass("wp-tooltip-button-clicked");
$this.addClass("wp-tooltip-button-clicked")}})},initReadMore:function(){var referringDomain=document.referrer.split("/")[2]||"";referringDomain=referringDomain.split(":")[0]||"";if(referringDomain!==location.hostname){var rmButton=$("\x3cbutton id\x3d'resumeReading'\x3eRead More\x3c/button\x3e").on("click",readMore);$("#article-body article").addClass("blockReading").after(rmButton)}function readMore(e){e.preventDefault();$(this).siblings(".blockReading").removeClass("blockReading").end().remove()}
},initResizableIframes:function(){var hasResizableIframe=false;$("iframe[width][height]",$article).each(function(){var $iframe=$(this),w=$iframe.attr("width"),h=$iframe.attr("height");if(!isNaN(w)&&!isNaN(h)){$iframe.attr("data-aspect-ratio",w/h);if($iframe.attr("width")!=$article.width()){var hFudgeFactor=!!$iframe.attr("src")&&$iframe.attr("src").match(/instagram.com/)?40:0;$iframe.attr("width",Math.round($article.width()));$iframe.attr("height",Math.round($article.width()/$iframe.attr("data-aspect-ratio"))+
hFudgeFactor)}if(!hasResizableIframe){hasResizableIframe=true;$w.resize(function(){$("iframe[data-aspect-ratio]",$article).each(function(){var $ifr=$(this);var hFF=!!$iframe.attr("src")&&$iframe.attr("src").match(/instagram.com/)?40:0;$ifr.attr("width",Math.round($article.width()));$ifr.attr("height",Math.round($article.width()/$ifr.attr("data-aspect-ratio"))+hFF)})})}}})},initAudio:function(){$("audio").each(function(){if($(this).find("source")[0]){var audioSrc=$(this).find("source")[0].src;var audioId=
$(this)[0].id;$(this).replaceWith('\x3cdiv class\x3d"audio-wrapper" id\x3d"'+audioId+'"\x3e\x3caudio preload\x3d"none"\x3e\x3csource src\x3d"'+audioSrc+'" type\x3d"audio/mp3" /\x3e\x3ca href\x3d"'+audioSrc+'"\x3e'+audioSrc+'\x3c/a\x3e\x3c/audio\x3e\x3cdiv class\x3d"audio-player"\x3e\x3cdiv class\x3d"play-button play"\x3e\x3c/div\x3e\x3cdiv class\x3d"progress-bar"\x3e\x3cdiv class\x3d"elapsed-bar"\x3e\x3c/div\x3e\x3cdiv class\x3d"playhead"\x3e\x3c/div\x3e\x3cdiv class\x3d"time"\x3e \x3cspan class\x3d"elapsed-time"\x3e00:00\x3c/span\x3e / \x3cspan class\x3d"total-time"\x3e00:00\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e')}});
$(".audio-wrapper").each(function(){var $this=$(this),$audio=$this.find("audio"),audio=$audio[0],$audioPlayer=$this.find(".audio-player"),$playButton=$audioPlayer.find(".play-button"),$progressBar=$audioPlayer.find(".progress-bar"),$elapsedBar=$audioPlayer.find(".elapsed-bar"),$playhead=$audioPlayer.find(".playhead"),$time=$progressBar.find(".time"),$elapsedTime=$time.find(".elapsed-time"),$totalTime=$time.find(".total-time");var duration;$audio.on("loadedmetadata",function(){duration=audio.duration;
$totalTime.text(formatDuration(duration))});$audio.trigger("load");var playheadWidth=$playhead.outerWidth(),progressBarWidth=$progressBar.outerWidth(),progressBarLeft=$progressBar.offset().left,firstPlayed=false,dragging=false,draggingWhilePaused=false;$playButton.click(function(){if(audio.paused){audio.play();$(this).removeClass("play").addClass("pause");if(firstPlayed===false){firstPlayed=true;$playhead.show()}}else{audio.pause();$(this).removeClass("pause").addClass("play")}});$audio.on("timeupdate",
audioUpdate);$w.on("resize",function(){progressBarWidth=$progressBar.outerWidth();progressBarLeft=$progressBar.offset().left;audioUpdate()});$progressBar.on("mousedown",function(e){if(e.which==1&&firstPlayed===true){e.preventDefault();dragging=true;if(audio.paused)draggingWhilePaused=true;else audio.pause();$w.on("mousemove",drag);$audio.off("timeupdate",audioUpdate)}});$w.on("mouseup",function(e){if(dragging===true){drag(e);$w.off("mousemove",drag);audio.currentTime=duration*((e.pageX-progressBarLeft)/
progressBarWidth);if(audio.currentTime>=duration){audio.pause();$playButton.removeClass("pause").addClass("play")}else if(!draggingWhilePaused)audio.play();$audio.on("timeupdate",audioUpdate)}dragging=false;draggingWhilePaused=false});function drag(e){var newLeft=e.pageX-progressBarLeft;if(newLeft>=0&&newLeft<=progressBarWidth){$playhead.css("left",newLeft-playheadWidth/2+"px");$elapsedBar.css("width",newLeft+"px")}if(newLeft<0){$playhead.css("left",-(playheadWidth/2)+"px");$elapsedBar.css("width",
"0px")}if(newLeft>progressBarWidth){$playhead.css("left",progressBarWidth-playheadWidth/2+"px");$elapsedBar.css("width",progressBarWidth+"px")}}function audioUpdate(){var elapsedBarWidth=progressBarWidth*(audio.currentTime/duration);$playhead.css("left",elapsedBarWidth-playheadWidth/2+"px");$elapsedBar.css("width",elapsedBarWidth+"px");if(audio.currentTime>=duration)$playButton.removeClass("pause").addClass("play");$elapsedTime.text(formatDuration(audio.currentTime))}function formatDuration(duration){var sec=
Math.floor(duration);var min=Math.floor(sec/60);min=min>=10?min:"0"+min;sec=Math.floor(sec%60);sec=sec>=10?sec:"0"+sec;return min+":"+sec}})},initVideo:function(){$article.find(".inline-video").each(function(){var $this=$(this);var $wpvPlayer=$this.find(".wpv-player");if($wpvPlayer.attr("data-show-caption")!=="1")$this.find(".inline-video-caption").show();else;})},initInlineLinks:function(){var inlineLinkConfig={ctx:"#article-body article",selector:'p a[href*\x3d"www\\.washingtonpost\\.com"]',param:"tid",
getParamValue:function(){return this.param+"\x3da_mcntx"}};var inlineLinkLocConfig={ctx:"#article-body article",selector:'p[data-elm-loc].interstitial-link a[href*\x3d"www\\.washingtonpost\\.com"], p[data-elm-loc].interstitial-link a[data-original-href*\x3d"www\\.washingtonpost\\.com"]',param:"tidloc",getParamValue:function(){var tidloc="";if(arguments.length>0){var $p=arguments[0].closest("p[data-elm-loc]");if($p.length>0)tidloc=$p.attr("data-elm-loc")}return this.param+"\x3d"+tidloc}};var inlineBioConfig=
{ctx:"#article-body article",selector:'.inline-content.author-bio a[href*\x3d"www\\.washingtonpost\\.com"]',param:"tid",getParamValue:function(){return this.param+"\x3da_bio"}};try{wp_pb.StaticMethods.parametrizeLinks.init([inlineLinkConfig,inlineLinkLocConfig,inlineBioConfig])}catch(e){}},initABTests:function(){_dw.push(["global","ready",function(api){api.get("upgrade-toolkit_v110")}])},initAuthorBioBox:function(){var authorBioBoxHandler={init:function(){try{if(window.mobile_browser||$(window).width()<
975)$(".pb-f-article-article-body .pb-author-wrapper").each(function(){var $this=$(this);if($this.find(".pb-author-modal-wrapper").length>0){$this.addClass("handle-as-mobile");var $modal=$this.find(".pb-author-modal-wrapper .slide-layer"),$otherModal=$this.siblings().find(".pb-author-modal-wrapper .slide-layer"),$modalWrapper=$this.find(".pb-author-modal-wrapper"),$closeBtn=$this.find(".pb-author-modal-wrapper .close-btn");var modalFadeIn=function(ev){if($modal.is(":hidden")){modalFadeOut();ev.preventDefault();
ev.stopPropagation();$modal.find(".pb-author-modal").css("width",window.innerWidth*.75+"px");$modalWrapper.css("margin-left","-"+$modal.outerWidth()/2+"px");$modal.show(200);$("body").on("click",modalFadeOut)}else if(ev.target.nodeName!="A"&&ev.target.nodeName!="IMG"){ev.preventDefault();ev.stopPropagation()}};var modalFadeOut=function(){$otherModal.hide(200);$modal.hide(200);$("body").off("click",modalFadeOut)};$this.on("click",modalFadeIn);$closeBtn.on("click",modalFadeOut)}});else{$(".pb-f-article-article-body").prepend('\x3cdiv id\x3d"pb-article-body-author-modals"\x3e\x3c/div\x3e');
$(".pb-f-article-article-body .pb-author-wrapper").each(function(){var $this=$(this);if($this.find(".pb-author-modal-wrapper").length>0){var $modal=$this.find(".pb-author-modal-wrapper .slide-layer"),transitionTimer,thisTop;$modal.appendTo($this.closest(".article-body").siblings("#pb-article-body-author-modals"));$this.add($modal).hover(function(){if(thisTop!=$this.closest(".pb-sig-line").position().top){var top=0,left=0;if($(".pb-f-article-article-body .headshot-to-the-left").length>0){top=parseFloat($(".article-body").css("margin-top"))+
$this.height()+$this.position().top+5;left=$this.position().left+20}else{top=parseFloat($(".article-body").css("margin-top"))+$this.position().top+$this.height()+5;left=$this.position().left+20}$modal.css({top:top+"px",left:left+"px"});thisTop=$this.closest(".pb-sig-line").position().top}if(transitionTimer){clearTimeout(transitionTimer);transitionTimer=null}transitionTimer=setTimeout(function(){$modal.show(200)},100)},function(ev){if(transitionTimer){clearTimeout(transitionTimer);transitionTimer=
null}var targetElement=ev.toElement;if(targetElement===undefined)targetElement=ev.relatedTarget;if($modal.has(targetElement).length===0&&$this.has(targetElement).length===0)$modal.hide(200)})}})}}catch(err){}}};authorBioBoxHandler.init()},initFactChecker:function(){if(window.wp_meta_data&&window.wp_meta_data.page_id&&window.wp_meta_data.page_id.length&&window.wp_meta_data.page_id[0].match(/^fact-checker\d+$/))if(window.wp_import)window.wp_import(["//dhpikd1t89arn.cloudfront.net/js/include/sharethefacts-v1.js"]).then(function(){if(window.sharethefacts_embed)try{window.sharethefacts_scanned=
false;window.sharethefacts_embed()}catch(e){}})},initExternalGameEmbed:function(){$article.find(".external-game-embed:not(.processed)").each(function(){var $this=$(this);if(typeof $this.attr("data-embed-src")!="undefined")$.ajax({type:"GET",url:$this.attr("data-embed-src"),success:function(data){$this.html(data);$this.removeClass("unprocessed").addClass("processed")}})})},init:function(){$article=$("#article-body");this.initIframes();this.initAboutTheAuthors();this.initTables();this.initGalleries();
this.initTooltips();this.initResizableIframes();this.initAudio();this.initVideo();this.initABTests();this.initInlineLinks();this.initAuthorBioBox();this.initFactChecker();this.initExternalGameEmbed();this.tryInitLoadTime()}};if(wp_pb.StaticMethods.isPageHydrated())feature.init();__e.push(["shamble",function(){feature.init()}]);$d.on("loadTimeUpdated",function(){$article=$("#article-body");feature.initLoadTime()})})(jQuery);
(function(){var __e=window.__e||[],commentButton=document.getElementById("comment_summary_button"),standalonePage="display-standalonePage",wp_pb=window.wp_pb||{},commentCount={init:function(){var wrapper=document.getElementById("comment_link_button_wrapper"),commentCountLink=document.getElementById("comment_count_inline"),assetUrl=commentCountLink?commentCountLink.dataset.guid:location.href;if(wrapper&&!wrapper.classList.contains(standalonePage))if(commentButton)commentButton.addEventListener("click",
function(){wp_pb.report("comments","showComments",{event:"click"})});if(commentCountLink){var commentSystem=commentCountLink.classList.contains("coral-counter")?"coral":"echo";wp_pb.report("comment_count_target","init",{targetName:"#comment_count_inline",targetUrl:assetUrl,commentSystem:commentSystem})}}};if(typeof wp_pb.StaticMethods=="undefined"||typeof wp_pb.StaticMethods.isPageHydrated=="undefined"||wp_pb.StaticMethods.isPageHydrated())commentCount.init();__e.push(["shamble",function(){commentCount.init()}])})();
(function($){__e=window.__e||[];var logger=!!window.TWP&&!!TWP.Tools&&!!TWP.Tools.logger?new TWP.Tools.logger("pb-f-page-share-bar"):window.console;var pageSocialTools={setUpTracking:function(){var $socialToolsBottom=$(".social-tools-bottom"),$individualTools=$socialToolsBottom.children(),config={omnitureEvent:"event6"};$individualTools.on("click",function(e){if(typeof window.sendDataToOmniture==="function"){var shareType=$(this).data("sharetype"),eventName=config.omnitureEvent,omnitureVars={eVar1:typeof window.s==
"object"&&s&&s.eVar1,eVar2:typeof window.s=="object"&&s&&s.eVar2,eVar8:typeof window.s=="object"&&s&&s.eVar8,eVar17:typeof window.s=="object"&&s&&s.eVar17,eVar27:""};omnitureVars.eVar27=shareType+"_bottom";try{sendDataToOmniture("share."+shareType,eventName,omnitureVars)}catch(e){logger.error(e)}}})},getSnowflake:function(){var currentSnowflake=TWP.Analytics&&TWP.Analytics.Snowflake?TWP.Analytics.Snowflake.getCurrent():{};return currentSnowflake.outgoing||""},init:function(){this.setUpTracking()}};
var lifecycle={init:function(){window.TWP=TWP||{};TWP.PageSocialTools=TWP.PageSocialTools||pageSocialTools;TWP.PageSocialTools.init()}};if(wp_pb.StaticMethods.isPageHydrated())lifecycle.init();__e.push(["shamble",function(){lifecycle.init()}])})(jQuery);
(function($){var feature={initSubscribe:function(){$(window.document).on("onTwpMeterReady onTwpMeterComplete",function(){if(wp_pb&&wp_pb.StaticMethods&&!wp_pb.StaticMethods.isSubscriber()){$(".pb-subscribe-promo").show();wp_pb.StaticMethods.updateImageRes($(".pb-subscribe-image-container img"),$(".pb-subscribe-image-container"),150)}})},init:function(){this.initSubscribe()}};var lifecycle={init:function(){feature.init()}};lifecycle.init()})(jQuery);
(function($){$(".pb-f-generic-promo-image").each(function(){var $hasLabel=$(this).find(".label-wrapper");if($hasLabel.length==0)$(this).find("\x3e:first-child").addClass("mobile-border")})})(jQuery);
(function(){var $=jQuery;var TWP=window.TWP||{};TWP.Perso=TWP.Perso||{};TWP.Perso.Tools=TWP.Perso.Tools||{};var T=TWP.Perso.Tools;var $sponsored=null;var $container=null;var $pbcontainer=null;var log=new TWP.Tools.logger("HYBRID");var validOnes=[];var clientString="recommend-strip-11";if(window["wp_meta_data"]&&window["wp_meta_data"]["isPWA"])clientString+="-pwa";try{var client=new TWP.Perso.Recommend(clientString,3)}catch(e){}var counterPointApi=null;var canonicalPage=document.querySelectorAll("link[rel\x3dcanonical]")[0];
var counterPointUrl="";var status="";var visible=false;var clickListenerAdded=false;var trackRenderedAllCalled=false;function _failure(error){log.debug("Failure",function(){$pbcontainer.hide();trackError(error);status="failed"})}function isValid(recommendation){return recommendation&&recommendation.url&&recommendation.responsetype&&recommendation.headline&&recommendation.summary&&recommendation.photo&&recommendation.photo.path}function render(recommendations){if(!recommendations||recommendations.length==
0)return _failure("no-recommendations");validOnes=[];for(var i=0;i<recommendations.length;i++)if(isValid(recommendations[i]))validOnes.push(recommendations[i]);if(validOnes.length==0)return _failure("no-valid-recommendations");log.debug("Render",function(){_renderArticle(validOnes)});status="rendered";trackVisible()}function initModal($container){var modal=$container.find(".story-label-explainer");modal.jqm({overlayClass:"story-label-explainer",closeClass:"label-modal-close",overlay:0,onHide:function(hash){hash.w.hide()&&
hash.o&&hash.o.remove();return true}});$container.find(".section-label-span").hover(function(){modal.jqmShow()});$(document).mouseup(function(e){if(!modal.is(e.target)&&modal.has(e.target).length===0)modal.jqmHide()});if(typeof window.Hammer==="function"&&wp_pb.BrowserInfo.mobile_browser)try{var hammertime=new window.Hammer($(".section-label-span")[0],{prevent_mouseevents:true});hammertime.on("tap",handleTap)}catch(err){log.debug(err)}function handleTap(ev){ev.gesture.preventDefault();ev.gesture.stopPropagation();
modal.jqmShow()}}function _renderArticle(recommendations){var idx=0;var html="";var counterHtml="";var classes="";for(var i=0;i<recommendations.length;i++)if(recommendations[i].responsetype==="hybrid_counterpoint_1_na"){log.debug("Render item ("+i+")");counterHtml=counterHtml+renderItem(recommendations[i],idx,recommendations.length);idx=idx+1}else{log.debug("Render item ("+i+")");html=html+renderItem(recommendations[i],idx,recommendations.length);idx=idx+1}html=renderRecHtml(html,classes,"The Post Recommends");
$sponsored=$("#slug_postrecommends");$sponsored.remove();if(counterHtml.length>0){counterHtml=renderRecHtml(counterHtml,"counterpoint","Counterpoint");$container.html(counterHtml);$container.append(html)}else $container.html(html);initModal($container);$container.find(".content-strip \x3e .label-wrapper").before($sponsored);$container.show();$pbcontainer.show();$pbcontainer.after('\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e');$(document).trigger("dom-manipulation-complete")}function renderRecHtml(html,
classes,label){var modal="";var modalLabel="";var counterpointLabel="";if(label==="Counterpoint"){modal='\x3cdiv class\x3d"story-label-explainer arrow_box"\x3e'+'\x3ci class\x3d"fa fa-times label-modal-close" aria-hidden\x3d"true"\x3e\x3c/i\x3e'+'\x3cp class\x3d"label-title Counterpoint"\x3e'+'\x3cb class\x3d"label"\x3eCounterpoint\x3c/b\x3e '+'\x3cspan class\x3d"label-content"\x3eAn Opinions piece that offers a different perspective from the article you\u2019re currently reading\x3c/span\x3e'+"\x3c/p\x3e"+
"\x3c/div\x3e";modalLabel="section-label-span";counterpointLabel='\x3cspan class\x3d"counterpoint-explainer"\x3e\x3ci class\x3d"fa fa-circle counterpoint-label-ic" aria-hidden\x3d"true"\x3e\x3c/i\x3e A different view on the issue\x3c/span\x3e'}return'\x3cdiv class\x3d"postrecommends contentfeed '+classes+'"\x3e'+'\x3cdiv class\x3d"content-strip"\x3e'+'\x3cdiv class\x3d"label-wrapper label-wrapper-post-recommends"\x3e'+'\x3cspan class\x3d"label label-kicker"\x3e\x3cspan class\x3d"'+modalLabel+'"\x3e'+
label+"\x3c/span\x3e\x3c/span\x3e"+counterpointLabel+modal+"\x3c/div\x3e"+'\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e'+html+'\x3cdiv class\x3d"clear"\x3e\x3c/div\x3e'+"\x3c/div\x3e"+"\x3c/div\x3e"}function renderURL(recommendation){var path=recommendation.url;if(path.indexOf("thelily.com")>0)return path+"?tid\x3d"+recommendation.responsetype;if(path.substring(0,4)==="http"){var location=document.createElement("a");location.href=path;path=location.pathname}var url="https://"+window.location.hostname+
path+"?tid\x3d"+recommendation.responsetype;return url}function renderImgURL(recommendation,w,h){var url=recommendation.photo.path;var re1=/(washingtonpost.com\/rf\/image_[^/]+\/)/;var re2=/(washingtonpost.com\/rw?\/)/;if(url.match(re1)||url.match(re2))url=url.replace(RegExp.$1,"washingtonpost.com/rf/image_"+w+"x"+h+"/");else url="https://www.washingtonpost.com/wp-apps/imrs.php?src\x3d"+encodeURIComponent(url)+"\x26w\x3d"+w+"\x26h\x3d"+h;return url}function renderClasses(recommendation,index,total){var classes=
"";if(recommendation.responsetype.match(/video/))classes=classes+"video ";if(index==0)classes=classes+"first ";if(index==total-1)classes=classes+"last";return classes}function renderItem(recommendation,index,total){var node=$($("#postrecommends-article-template").html());node.addClass(renderClasses(recommendation,index,total));var headline=node.find(".headline a");headline.html(recommendation.headline);headline.attr("href",renderURL(recommendation));var labelWrapper=node.find(".label-wrapper");var label=
node.find(".label");if(recommendation["storyType"])label.text(recommendation["storyType"]);else if(recommendation["url"].indexOf("thelily.com")>0)label.html('\x3ca href\x3d"https://www.thelily.com/"\x3e'+'\x3cimg class\x3d"lilylogo" src\x3d"https://wp-stat.s3.amazonaws.com/perso/recommendations/lily-logo.png"/\x3e'+"\x3c/a\x3e");else labelWrapper.remove();var linkImg=node.find(".photo-wrapper a");linkImg.attr("href",renderURL(recommendation));var blurb=node.find(".blurb");blurb.html(recommendation.summary);
var displayDate=recommendation.displayDate||recommendation.publishedAt;if(displayDate){displayDate=wp_pb.StaticMethods.getTwitterTime(displayDate);blurb.after('\x3cdiv class\x3d"timestamp"\x3e'+displayDate+"\x3c/div\x3e")}var img='\x3cimg alt\x3d"" src\x3d"'+renderImgURL(recommendation,480,320)+'"'+' data-hi-res-src\x3d"'+renderImgURL(recommendation,480,320)+'"'+' data-low-res-src\x3d"'+renderImgURL(recommendation,112,75)+'"'+' data-threshold\x3d"112" class\x3d"courtesy-of-the-resizer"\x3e';node.find(".photo-wrapper img").replaceWith(img);
if(recommendation.responsetype.match(/video/)){var time="";if(recommendation.videoDuration&&recommendation.videoDuration>1E3){var seconds=Math.floor(recommendation.videoDuration/1E3);var minutes=Math.floor(seconds/60);seconds=seconds%60;if(seconds<10)seconds="0"+seconds.toString();time=minutes+":"+seconds}var caption='\x3cdiv class\x3d"standalone-overlay posttv-playlist-text-play-btn"\x3e'+'\x3ca class\x3d"video-play" href\x3d"'+renderURL(recommendation)+'"\x3e'+'\x3cspan class\x3d"fa fa-play icon-left"\x3e\x3c/span\x3e\x3cspan\x3ePlay Video\x3c/span\x3e'+
'\x3cspan class\x3d"duration"\x3e'+time+"\x3c/span\x3e"+"\x3c/a\x3e"+"\x3c/div\x3e";blurb.after(caption)}return node[0].outerHTML}function clickTracker(ev){var link=this;var mClick=ev.button>0||ev.ctrlKey||ev.metaKey||ev.shiftKey;var prefetched=$(link).hasClass("pre-fetched");log.debug("Click",function(){var href=link.href;var tid=href.replace(/.*\?tid=/,"");log.debug("URL : "+href);trackClicked(client,href,tid);var newHref=href;newHref=newHref.replace(/.*wpprivate.com\/pb/,"https://www.washingtonpost.com");
newHref=newHref.replace(/.*localhost:8888\/pb/,"https://www.washingtonpost.com");if(newHref.split("?")[0]===counterPointUrl.href)serveCounterStats("clicked");if(mClick||prefetched);else setTimeout(function(){log.debug("Redirecting");document.location=href},200)});return mClick||prefetched}function trackClicks(){if(!clickListenerAdded){clickListenerAdded=true;$pbcontainer.on("click",".row a",null,clickTracker)}}function trackClicked(client,url,tid){T.Omniture.send("post_recommends","",{prop69:tid},
log);client.clicked(url)}function trackVisible(){if(status=="rendered"&&visible&&!trackRenderedAllCalled){trackRenderedAllCalled=true;var param=[];for(var i=0;i<validOnes.length;i++){param.push(validOnes[i].responsetype);if(validOnes[i].responsetype==="hybrid_counterpoint_1_na"){var parser=document.createElement("a");parser.href=validOnes[i].url;counterPointUrl=parser;serveCounterStats("served")}}var props={prop72:param.join(",")};T.Omniture.send("post_recommends","",props,log);client.rendered()}}
function serveCounterStats(type){var parsedOpinion=document.createElement("a");parsedOpinion.href=canonicalPage.href;var opinionUrl=parsedOpinion.pathname;var params="opinion_url\x3d"+opinionUrl+"\x26counterpoint_url\x3d"+counterPointUrl.pathname+"\x26stype\x3d"+type;var sReq=new XMLHttpRequest;sReq.open("POST",counterPointApi,true);sReq.setRequestHeader("Content-type","application/x-www-form-urlencoded");sReq.send(params)}function trackError(){}function _preload(){log.debug("Setting up click handlers");
trackClicks();log.debug("Requesting recommendations");client.recommend().done(function(data){render(data["results"])})}function _visible(){log.debug("Visible",function(){visible=true;trackVisible()})}function _init(){log.debug("DOM Ready",function(){try{log.debug("(Re)Init variables");status="";visible=false;trackRenderedAllCalled=false;counterPointApi=wp_pb.recommendationEnv&&wp_pb.recommendationEnv.COUNTERPOINT_API;log.debug("Finding containers");$container=$("#post-recommends");$container.hide();
if(!$pbcontainer||$pbcontainer.length==0)$pbcontainer=$container.parent();if($container.length==1){log.debug("Setting up scroll listener");if(document.location.toString().match(/\/lifestyle\/kidspost\//)){T.Events.smartPreload($pbcontainer,{});$pbcontainer.hide()}else T.Events.smartPreload($pbcontainer,{preload:_preload,visible:_visible,screens:2})}}catch(e){trackError("init-error")}})}if(wp_pb.StaticMethods.isPageHydrated())$(function(){_init()});var shambleEvent=window.__e;shambleEvent.push(["shamble",
function(){_init()}])})();
(function($){var logger=window.TWP&&TWP.Tools&&TWP.Tools.logger?new TWP.Tools.logger("feature-loader"):window.console;function makeLoadFeatureFunc(baseConfig,baseOptions){baseConfig=baseConfig||{};baseOptions=baseOptions||{};return function(config,options){var conf=$.extend(baseConfig,config);var thisoptions=$.extend(baseOptions,options);wp_pb.StaticMethods.loadFeature(conf,thisoptions)}}var loaderInstances=$(".pb-f-tools-feature-loader");loaderInstances.each(function(i,el){var $el=$(el);var $config=
$(".feature-loader-config",$el);var id=$el.attr("id");if(!$config.length||!id)return;var contentUri=$config.data("contenturi");var loadFeature=makeLoadFeatureFunc({el:id},contentUri?{contentUri:contentUri}:null);var actionFuncs={loadFeature:loadFeature};var conditionsURL=$config.data("conditionsurl");if(conditionsURL){$.get(conditionsURL).then(handler).then(null,function(e){logger.error(e)});return}if($config.is("script")){var conditions;try{conditions=JSON.parse($config.html())}catch(e){logger.error(e);
return}if(conditions){handler(conditions);return}}function handler(configs){ConditionManager.makeFromConfig({configs:configs,conditionFuncs:wp_pb.conditions,actionFuncs:actionFuncs})}})})(window.jQuery);
(function($){function trackModalDisplay(){if(!!window.s){var props={eVar1:s.eVar1,eVar2:s.eVar2,eVar26:"apple-pay-modal"};window.sendDataToOmniture&&sendDataToOmniture("apple pay modal","event66",props)}}function localStorageAvailable(){var test="test";try{localStorage.setItem(test,test);localStorage.removeItem(test);return true}catch(e){return false}}var ApplePayModal={showOverlay:function(){if(localStorageAvailable()){var $this=this;$modal=$("#apple-signup-overlay");$modal.jqm({overlay:85,modal:true,
toTop:true,trigger:false,closeClass:"overlay-closer",onShow:function(h){h.o.prependTo("#pb-root");$("html").addClass("applepay-modal-up");h.w.show();localStorage.setItem("applepay-modal-seen",true);setTimeout(function(){trackModalDisplay()},1E3)},onHide:function(h){$("html").removeClass("applepay-modal-up");$(".pb-f-page-apple-pay-modal").addClass("applepay-modal-minimized");h.w.fadeOut("2000",function(){h.o.remove()})}});$modal.jqmShow()}},supportedDevice:function(){return location.protocol==="https:"&&
"ApplePaySession"in window},canMakePayments:function(){try{return ApplePaySession.canMakePayments()}catch(e){return false}},canMakePaymentsWithActiveCard:function(merchantID){merchantID=merchantID||"merchant.com.washingtonpost";try{return ApplePaySession.canMakePaymentsWithActiveCard(merchantID)}catch(e){return false}},init:function(){var $this=this;var modalNotSeen=localStorage.getItem("applepay-modal-seen")!=="true";var isSubscriber=/rplsb=1/.test(document.cookie);var UPCCheck=$.cookie("rplmct")==
2||$.cookie("rplmct")==4;if(modalNotSeen&&!isSubscriber&&UPCCheck&&$this.supportedDevice()&&$this.canMakePayments())$this.canMakePaymentsWithActiveCard().then(function(supported){if(supported)$this.showOverlay()});$("#apple-signup-minimized").click(function(){$(".pb-f-page-apple-pay-modal").removeClass("applepay-modal-minimized");$this.showOverlay()});wp_pb.register("breakingnews","reload",function(){if($(".pb-f-page-breaking-news-bar").height()>0)$("#apple-signup-overlay .apple-pay-contet").addClass("breaking-news-bar-open");
else $("#apple-signup-overlay .apple-pay-contet").removeClass("breaking-news-bar-open")});wp_pb.register("breakingnews","close",function(){if($(".pb-f-page-breaking-news-bar").height()>0)$("#apple-signup-overlay .apple-pay-contet").addClass("breaking-news-bar-open");else $("#apple-signup-overlay .apple-pay-contet").removeClass("breaking-news-bar-open")})}};if($("#apple-signup-overlay").length)ApplePayModal.init()})(jQuery);
(function($,TWP){var logger=new TWP.Tools.logger("flex");var applyStickiness=function(){var $window=$(window),$ad=$(".pb-f-ad-flex"),$ad_div=$($ad.children()[0]),slotId="slug_flex_ss_bb_hp",adSize=0,inRightRail=false,$right_rail=$("#right-rail"),min_viewport=990;$ad.on("DOMNodeInserted",function(e){var $el=$(e.target),id=$el.attr("id");if($el.is("iframe")&&id&&!/(hidden)/g.test(id)){$ad.off("DOMNodeInserted");$ad.addClass("sticky");afterAdInserted($el)}});var bindScrollDown=function(){var scrollTop,
stopTop=$ad.offset().top+$ad.height()-$ad_div.outerHeight()-50;var getTopPoint=function(){return $ad.offset().top-50};var getMarginLeft=function(){var left=($ad.outerWidth()-adSize)/2;return left<0?0:left};var getRailMarginLeft=function(){if(inRightRail){var railLeft=($right_rail.width()-$ad_div.width())/2;return railLeft<0?0:railLeft}else return getMarginLeft()};var getAdLeft=function(){return $ad.offset().left};var applySticky=function(top){var left=0;if(inRightRail&&top<stopTop){left=$right_rail.offset().left;
$ad_div.css({top:50,left:left,position:"fixed",width:$right_rail.width()})}else if(top<stopTop){left=getAdLeft()+getMarginLeft();$ad_div.css({top:50,left:left,position:"fixed"})}else{var bTop=$ad.height()-$ad_div.height();left=getRailMarginLeft();$ad_div.css({top:bTop,left:left,position:"absolute"})}};var removeSticky=function(){if($ad.hasClass("sticky")){$ad.removeClass("sticky");$ad_div.attr("style","");$window.off("scroll.flexAd-sticky")}};$window.off("scroll.flexAd-sticky").on("scroll.flexAd-sticky",
function(){scrollTop=$window.scrollTop();if(scrollTop>getTopPoint())applySticky(scrollTop);else if($ad.hasClass("sticky"))$ad_div.css({top:0,position:"static",left:getRailMarginLeft()})});$window.off("resize.flexAd-sticky").on("resize.flexAd-sticky",function(){if($(window).outerWidth()>min_viewport)if($ad.hasClass("sticky")){var left=0;if($ad_div.css("position")==="fixed")left=getAdLeft()+getMarginLeft();else left=getRailMarginLeft();$ad_div.css({left:left})}else{$ad.addClass("sticky");startSticky()}else removeSticky()});
$ad.on("flexAd.remove_sticky",function(){$window.off("resize.flexAd-sticky");removeSticky()})};function startSticky(){if($(window).outerWidth()>min_viewport)bindScrollDown();else $window.on("resize.flexAd-invisible",function(){if($ad.is(":visible"))bindScrollDown();else $ad.trigger("flexAd.remove_sticky")})}var afterAdInserted=function(){if(window.googletag&&googletag.pubadsReady)googletag.pubads().addEventListener("slotRenderEnded",function(event){if(event.slot.getSlotElementId()===slotId){adSize=
event.size[0];inRightRail=$ad.parent("#right-rail").length>0;logger.log("Flex unit rendered");if(event.size[1]<1050)startSticky()}})}};if(TWP&&TWP.Features&&TWP.Features.Ad&&TWP.Features.Ad.flexAd&&TWP.Features.Ad.flexAd.sticky)applyStickiness()})(jQuery,TWP);
!function(a,b,c){var d=a[b],e=c(a,a.document);a[b]=e,a[b].noConflict=function(){return a[b]=d,e}}(this,"VisSense",function(a,b,c){function d(a,b){return function(){var d=arguments;return g(function(){a.apply(c,d)},b||0)}}function e(a,b){var c=q;return function(){var d=this,e=arguments;c(),c=g(function(){a.apply(d,e)},b)}}function f(a,b){var d=p(b),e=p(a);return d||e?d&&e?(j(Object.keys(b),function(d){a[d]===c&&(a[d]=b[d])}),a):d?b:a:b}function g(a,b){var c=setTimeout(function(){a()},b||0);return function(){clearTimeout(c)}}
function h(a,b){return function(){return(o(a)?a():a)?b():c}}function i(a,b,c){for(var d=-1,e=Object.keys(b),f=e.length,g=o(c);++d<f;){var h=e[d];a[h]=g?c(a[h],b[h],h,a,b):b[h]}return a}function j(a,b,d){for(var e=0,f=a.length;f>e;e++){var g=b.call(d,a[e],e,a);if(g!==c)return g}}function k(a){return a}function l(a){return a!==c}function m(a){return a&&"object"==typeof a&&"number"==typeof a.length&&"[object Array]"===Object.prototype.toString.call(a)||!1}function n(a){return a&&1===a.nodeType||!1}function o(a){return"function"==
typeof a||!1}function p(a){var b=typeof a;return"function"===b||a&&"object"===b||!1}function q(){}function r(){return(new Date).getTime()}function s(a){var b,d=!1;return function(){return d||(b=a.apply(c,arguments),d=!0),b}}function t(a,b,c){var d=q,e=!1;return function(){var f=r(),h=arguments,i=function(){e=f,a.apply(c,h)};e&&e+b>f?(d(),d=g(i,b)):(e=f,g(i,0))}}function u(b){var c=b||a;return{height:c.innerHeight,width:c.innerWidth}}function v(b,c){return(c||a).getComputedStyle(b,null)}function w(a,
b){return a.getPropertyValue(b)}function x(a,b){b||(b=v(a));var c=w(b,"display");if("none"===c)return!1;var d=a.parentNode;return n(d)?x(d):!0}function y(b,c){if(b===(c||a).document)return!0;if(!b||!b.parentNode)return!1;var d=v(b,c),e=w(d,"visibility");return"hidden"===e||"collapse"===e?!1:x(b,d)}function z(a,b){return!a||a.width<=0||a.height<=0?!1:a.bottom>0&&a.right>0&&a.top<b.height&&a.left<b.width}function A(a,b){var c=a.getBoundingClientRect(),d=u(b);if(!z(c,d)||!y(a))return 0;var e=0,f=0;return c.top>=
0?e=Math.min(c.height,d.height-c.top):c.bottom>0&&(e=Math.min(d.height,c.bottom)),c.left>=0?f=Math.min(c.width,d.width-c.left):c.right>0&&(f=Math.min(d.width,c.right)),Math.round(e*f/(c.height*c.width)*1E3)/1E3}function B(b){return!F(b||a).isHidden()}function C(b,c){if(!(this instanceof C))return new C(b,c);if(!n(b))throw new Error("not an element node");this._element=b,this._config=f(c,{fullyvisible:1,hidden:0,referenceWindow:a,percentageHook:A,visibilityHooks:[]});var d=F(this._config.referenceWindow);
this._config.visibilityHooks.push(function(){return!d.isHidden()})}function D(a,b){var c=a.state(),d=c.percentage;return b&&d===b.percentage&&b.percentage===b.previous.percentage?b:c.hidden?C.VisState.hidden(d,b):c.fullyvisible?C.VisState.fullyvisible(d,b):C.VisState.visible(d,b)}function E(a,b){var c=f(b,{strategy:[new E.Strategy.PollingStrategy,new E.Strategy.EventStrategy],async:!1});this._visobj=a,this._state={},this._started=!1;var d="*#"+r();this._pubsub=new G({async:c.async,anyTopicName:d}),
this._events=[d,"start","stop","update","hidden","visible","fullyvisible","percentagechange","visibilitychange"],this._strategy=new E.Strategy.CompositeStrategy(c.strategy),this._strategy.init(this),this._pubsub.on("update",function(a){var b=a._state.percentage,c=a._state.previous.percentage;b!==c&&a._pubsub.publish("percentagechange",[a,b,c])}),this._pubsub.on("update",function(a){a._state.code!==a._state.previous.code&&a._pubsub.publish("visibilitychange",[a])}),this._pubsub.on("visibilitychange",
function(a){a._state.visible&&!a._state.previous.visible&&a._pubsub.publish("visible",[a])}),this._pubsub.on("visibilitychange",function(a){a._state.fullyvisible&&a._pubsub.publish("fullyvisible",[a])}),this._pubsub.on("visibilitychange",function(a){a._state.hidden&&a._pubsub.publish("hidden",[a])}),j(this._events,function(a){o(c[a])&&this.on(a,c[a])},this)}var F=function(b){return function(a,b){var c=function(a,b){return{property:a,event:b}},d="visibilitychange",e=[c("webkitHidden","webkit"+d),c("msHidden",
"ms"+d),c("mozHidden","moz"+d),c("hidden",d)],f=j(e,function(c){return a[c.property]!==b?{isHidden:function(){return!!a[c.property]||!1},onVisibilityChange:function(b){return a.addEventListener(c.event,b,!1),function(){a.removeEventListener(c.event,b,!1)}}}:void 0});return f||{isHidden:function(){return!1},onVisibilityChange:function(){return q}}}((b||a).document)},G=function(a){function b(a){this._cache={},this._onAnyCache=[],this._config=f(a,{async:!1,anyTopicName:"*"})}var c=function(a,b){j(a,
function(a){a(b)})};return b.prototype.on=function(b,c){if(!o(c))return q;var e=function(b){return c.apply(a,b||[])},f=this._config.async?d(e):e,g=function(a,b,c){return function(){var c=b.indexOf(a);return c>-1?(b.splice(c,1),!0):!1}};return b===this._config.anyTopicName?(this._onAnyCache.push(f),g(f,this._onAnyCache,"*")):(this._cache[b]||(this._cache[b]=[]),this._cache[b].push(f),g(f,this._cache[b],b))},b.prototype.publish=function(a,b){var e=(this._cache[a]||[]).concat(a===this._config.anyTopicName?
[]:this._onAnyCache),f=!!this._config.async,g=f?d(c):function(a,b){return c(a,b),q};return g(e,b||[])},b}();C.prototype.state=function(){var a=j(this._config.visibilityHooks,function(a){return a(this._element)?void 0:C.VisState.hidden(0)},this);return a||function(a,b){var c=b.percentageHook(a,b.referenceWindow);return c<=b.hidden?C.VisState.hidden(c):c>=b.fullyvisible?C.VisState.fullyvisible(c):C.VisState.visible(c)}(this._element,this._config)},C.prototype.percentage=function(){return this.state().percentage},
C.prototype.element=function(){return this._element},C.prototype.referenceWindow=function(){return this._config.referenceWindow},C.prototype.isFullyVisible=function(){return this.state().fullyvisible},C.prototype.isVisible=function(){return this.state().visible},C.prototype.isHidden=function(){return this.state().hidden},C.fn=C.prototype,C.of=function(a,b){return new C(a,b)};var H={HIDDEN:[0,"hidden"],VISIBLE:[1,"visible"],FULLY_VISIBLE:[2,"fullyvisible"]};return C.VisState=function(){function a(a,
b,c){return c&&delete c.previous,{code:a[0],state:a[1],percentage:b,previous:c||{},fullyvisible:a[0]===H.FULLY_VISIBLE[0],visible:a[0]===H.VISIBLE[0]||a[0]===H.FULLY_VISIBLE[0],hidden:a[0]===H.HIDDEN[0]}}return{hidden:function(b,c){return a(H.HIDDEN,b,c)},visible:function(b,c){return a(H.VISIBLE,b,c)},fullyvisible:function(b,c){return a(H.FULLY_VISIBLE,b,c)}}}(),E.prototype.visobj=function(){return this._visobj},E.prototype.publish=function(a,b){var c=this._events.indexOf(a)>=0;if(c)throw new Error('Cannot publish internal event "'+
a+'" from external scope.');return this._pubsub.publish(a,b)},E.prototype.state=function(){return this._state},E.prototype.start=function(a){if(this._started)return this;var b=f(a,{async:!1});return this._cancelAsyncStart&&this._cancelAsyncStart(),b.async?this.startAsync():(this.update(),this._pubsub.publish("start",[this]),this._strategy.start(this),this._started=!0,this)},E.prototype.startAsync=function(a){this._cancelAsyncStart&&this._cancelAsyncStart();var b=this,c=g(function(){b.start(i(f(a,
{}),{async:!1}))});return this._cancelAsyncStart=function(){c(),b._cancelAsyncStart=null},this},E.prototype.stop=function(){this._cancelAsyncStart&&this._cancelAsyncStart(),this._started&&(this._strategy.stop(this),this._pubsub.publish("stop",[this])),this._started=!1},E.prototype.update=function(){this._state=D(this._visobj,this._state),this._pubsub.publish("update",[this])},E.prototype.on=function(a,b){return this._pubsub.on(a,b)},E.Builder=function(){var a=function(a,b){var c=null,d=a.strategy===
!1,e=!d&&(a.strategy||b.length>0);if(e){var f=!!a.strategy,g=m(a.strategy),h=f?g?a.strategy:[a.strategy]:[];c=h.concat(b)}else c=d?[]:a.strategy;return c};return function(b){var c={},d=[],e=[],f=!1,g=null;return{set:function(a,b){return c[a]=b,this},strategy:function(a){return d.push(a),this},on:function(a,b){return e.push([a,b]),this},build:function(h){var i=function(){var h=a(c,d);c.strategy=h;var i=b.monitor(c);return j(e,function(a){i.on(a[0],a[1])}),f=!0,g=i},k=f?g:i();return o(h)?h(k):k}}}}(),
E.Strategy=function(){},E.Strategy.prototype.init=q,E.Strategy.prototype.start=q,E.Strategy.prototype.stop=q,E.Strategy.CompositeStrategy=function(a){this._strategies=m(a)?a:[a]},E.Strategy.CompositeStrategy.prototype=Object.create(E.Strategy.prototype),E.Strategy.CompositeStrategy.prototype.init=function(a){j(this._strategies,function(b){o(b.init)&&b.init(a)})},E.Strategy.CompositeStrategy.prototype.start=function(a){j(this._strategies,function(b){o(b.start)&&b.start(a)})},E.Strategy.CompositeStrategy.prototype.stop=
function(a){j(this._strategies,function(b){o(b.stop)&&b.stop(a)})},E.Strategy.PollingStrategy=function(a){this._config=f(a,{interval:1E3}),this._started=!1},E.Strategy.PollingStrategy.prototype=Object.create(E.Strategy.prototype),E.Strategy.PollingStrategy.prototype.start=function(a){return this._started||(this._clearInterval=function(b){var c=setInterval(function(){a.update()},b);return function(){clearInterval(c)}}(this._config.interval),this._started=!0),this._started},E.Strategy.PollingStrategy.prototype.stop=
function(){return this._started?(this._clearInterval(),this._started=!1,!0):!1},E.Strategy.EventStrategy=function(a){this._config=f(a,{throttle:50}),this._config.debounce>0&&(this._config.throttle=+this._config.debounce),this._started=!1},E.Strategy.EventStrategy.prototype=Object.create(E.Strategy.prototype),E.Strategy.EventStrategy.prototype.start=function(a){return this._started||(this._removeEventListeners=function(b){var c=F(a.visobj().referenceWindow()),d=c.onVisibilityChange(b);return addEventListener("scroll",
b,!1),addEventListener("resize",b,!1),addEventListener("touchmove",b,!1),function(){removeEventListener("touchmove",b,!1),removeEventListener("resize",b,!1),removeEventListener("scroll",b,!1),d()}}(t(function(){a.update()},this._config.throttle)),this._started=!0),this._started},E.Strategy.EventStrategy.prototype.stop=function(){return this._started?(this._removeEventListeners(),this._started=!1,!0):!1},C.VisMon=E,C.PubSub=G,C.fn.monitor=function(a){return new E(this,a)},C.Utils={async:d,debounce:e,
defaults:f,defer:g,extend:i,forEach:j,fireIf:h,identity:k,isArray:m,isDefined:l,isElement:n,isFunction:o,isObject:p,isPageVisible:B,isVisibleByStyling:y,noop:q,now:r,once:s,throttle:t,percentage:A,VisibilityApi:F(),createVisibilityApi:F,_viewport:u,_isInViewport:z,_isDisplayed:x,_computedStyle:v,_styleProperty:w},C});
!function(e,t){typeof module!="undefined"?module.exports=t():typeof define=="function"&&typeof define.amd=="object"?define(t):this[e]=t()}("domready",function(e){function p(e){h=1;while(e=t.shift())e()}var t=[],n,r=!1,i=document,s=i.documentElement,o=s.doScroll,u="DOMContentLoaded",a="addEventListener",f="onreadystatechange",l="readyState",c=o?/^loaded|^c/:/^loaded|c/,h=c.test(i[l]);return i[a]&&i[a](u,n=function(){i.removeEventListener(u,n,r),p()},r),o&&i.attachEvent(f,n=function(){/^c/.test(i[l])&&
(i.detachEvent(f,n),p())}),e=o?function(n){self!=top?h?n():t.push(n):function(){try{s.doScroll("left")}catch(t){return setTimeout(function(){e(n)},50)}n()}()}:function(e){h?e():t.push(e)}});
(function($,wp_pb){if(!(document.location.toString().match(/from-prime-time-hearthrob-to-hollywood-freak/)||document.location.toString().match(/islamic-states-embrace-of-social-media-puts-tech-companies-in-a-bind/)))return;domready(function(){debug("DOM Ready");domReady=true;article=$("#article-body")});var $b=$("body");var $w=$(window);var $d=$(document);var init=function(){};var initNoKmap=function(){};var start=Date.now();var $html=$("html");var $body=$("body");var $window=$(window);var $header=
$("#wp-header");var ad=null;var closer=null;var signup=null;var footer=null;var article=null;var sidebar=null;var children=null;var container=null;var selector=".kmap-info, .kmap-keyword, .kmap-inline-trigger, .kmap-person-trigger, .kmap-series-trigger, .kmap-theme-buttons";var sidebarActivated=false;var initialScroll=0;var pr=false;var darwin=false;var abdarwin=false;var abvariant=null;var devmode=false;var domReady=false;var mockupData="";var mockupReady=false;var featureStarted=false;var sviFull=
document.cookie.match(/s_vi=([^;]+)/)?RegExp.$1:"";var visibility={};var screenSize=0;var toRemove=[];if(document.location.toString().match(/[?&#]kmap=1/)||window.localStorage&&window.localStorage.getItem("kmap"))$(window.document).on("abtest-before",function(e,ABT){debug("Forcing experience in Darwin");trackEvent("ready","darwin-before");abvariant="experiment";ABT.forceTest("knowledgemap-experiment1","experiment")});if(document.location.toString().match(/[?&#]pr=1/))pr=true;var initFeature=function(){if(!domReady||
!mockupReady||!darwin){if(domready&&mockupReady&&!darwin&&Date.now()-start<5E3)setTimeout(initFeature,100);if(Date.now()-start<6E4)setTimeout(initFeature,100);else debug("Giving up");return}if(featureStarted)return;else{featureStarted=true;if(darwin){abdarwin=true;var variation=darwin.get("knowledgemap-experiment1");if(variation.is("experiment"))abvariant="experiment"}else debug("Darwin not ready");if(abvariant=="experiment"){if(devmode)article.html(mockupData);else article.append(mockupData);debug("Initializing");
init();debug("Tracking pageview");trackEvent("experiment","pageview");debug("Initializing (done)")}else{article.append(mockupData);debug("Initializing");initNoKmap();debug("Tracking pageview");trackEvent("default","pageview");debug("Initializing (done)")}}};setTimeout(initFeature,200);$(window.document).on("abtest-ready",function(e,ABT){darwin=ABT;debug("Darwin is ready");trackEvent("ready","darwin");initFeature()});var logs=[];var groupLevel=0;function debug(msg){msgline="[DBGKMAP] "+msg+" ("+(Date.now()-
start)+"ms)";logs.push(msgline);if(window.localStorage&&localStorage.getItem("debug-knowledge-map"))console.log(msgline)}function debugGroupStart(name){groupLevel=groupLevel+1;msgline="[DBGKMAP] "+name;logs.push("\x3e\x3e "+msgline);if(window.localStorage&&localStorage.getItem("debug-knowledge-map"))if(window.console&&console.group)console.group(msgline)}function debugGroupEnd(){groupLevel=groupLevel-1;msgline="[DBGKMAP] "+name;logs.push("\x3c\x3c "+msgline);if(window.localStorage&&localStorage.getItem("debug-knowledge-map"))if(window.console&&
console.groupEnd)console.groupEnd()}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}function updateUrlParam(url,key,value){value=encodeURIComponent(value);var n=new RegExp("([?\x26])"+key+"\x3d.*?(\x26|$)","i");var i=-1!==url.indexOf("?")?"\x26":"?";return url.match(n)?
url.replace(n,"$1"+key+"\x3d"+value+"$2"):url+i+key+"\x3d"+value}debug("Adding fonts CSS");$("head").append('\x3clink rel\x3d"stylesheet" href\x3d"/pb/resources/css/fonts.css?_\x3d'+wp_pb.resourceToken+'" type\x3d"text/css"/\x3e');if(window.localStorage&&localStorage.getItem("kmap-development-mockup-url")&&localStorage.getItem("kmap-development-mockup-css")){devmode=true;var mockupURL=localStorage.getItem("kmap-development-mockup-url");var mockupCSS=localStorage.getItem("kmap-development-mockup-css");
$("head").append('\x3clink rel\x3d"stylesheet" href\x3d"'+mockupCSS+'" type\x3d"text/css"/\x3e');$.get(mockupURL,{},function(data){debug("Downloading mockup HTML (done)");mockupData=data;mockupReady=true;abvariant="experiment"},"html")}else $.get("https://www.washingtonpost.com/wp-stat/html/post/isis.html",{},function(data){debug("Downloading mockup HTML (done)");mockupData=data;mockupReady=true});var handleBodyscroll=function(){if(window.innerWidth<=768&&container.hasClass("visible"))$html.addClass("kmapnoscroll");
else $html.removeClass("kmapnoscroll")};var handleScrollAndResize=function(){if(devmode)return;handleBodyscroll();var sidebarPosition=sidebar.offset();var scrollPosition=$window.scrollTop();var topPosition=0;if($header.hasClass("bar-hidden"))topPosition=0;else topPosition=$("#nav-bar").outerHeight();if($(".top-sharebar-fixed").length>0)topPosition=topPosition+$(".top-sharebar-fixed").outerHeight();if(scrollPosition+topPosition>sidebarPosition.top){container.addClass("sticky");container.css("top",
topPosition);container.css("left",sidebarPosition.left);container.css("width",sidebar.width())}else{container.removeClass("sticky");container.css("top",0);container.css("left",0);container.css("width","100%")}};var resizeImages=function(initial){$(container).find("img").each(function(i,img){$img=$(img);var zoom=false;var src=$img.data("origsrc");var width=window.innerWidth;var resize="https://www.washingtonpost.com/wp-apps/imrs.php?src\x3d"+encodeURIComponent(src);var oldScreenSize=screenSize;if(width<=
450){screenSize=450;resize=resize+"\x26w\x3d450"}else if(width<=560){screenSize=560;resize=resize+"\x26w\x3d560"}else if(width<=768){screenSize=768;resize=resize+"\x26w\x3d768"}else{zoom=true;screenSize=1024;resize=resize+"\x26w\x3d285"}if(oldScreenSize==screenSize&&!initial)return;debug("Resize image URLs");$img.attr("src",resize);$img.off("click.modal");$img.removeClass("zoom-in");$(".modal-image-in-focus").remove();$(".overlay-image-in-focus").remove();if($img.parent().is("a"))zoom=false;if(zoom){var modalClass=
"modal-kmap-"+i;$img.addClass("zoom-in");$img.addClass(modalClass);$("\x3cimg/\x3e").attr("src",src).load(function(){var placeholder,defaultTopMargin=$w.height()<480?0:40,defaultLeftMargin=$w.width()<760?0:40,rawWidth=this.width,rawHeight=this.height,displayWidth=$img.width(),displayHeight=$img.height(),bodyWidth=$b.width(),windowWidth=$w.width(),screenWidth=(bodyWidth<windowWidth?bodyWidth:windowWidth)-2*defaultLeftMargin,screenHeight=$w.height()-2*defaultTopMargin,isRawImageMoreHorizontalThanScreen=
rawWidth/screenWidth>=rawHeight/screenHeight,isRawImageMoreVerticalThanScreen=!isRawImageMoreHorizontalThanScreen,isRawImageBig=rawWidth*rawHeight>displayWidth*displayHeight,isRawImageTooWide=rawWidth>screenWidth,isRawImageTooTall=rawHeight>screenHeight,dimensions={w:screenWidth,h:screenHeight,t:defaultTopMargin,l:defaultLeftMargin};if(isRawImageTooWide&&isRawImageTooTall)if(isRawImageMoreHorizontalThanScreen)dimensions.t+=Math.floor((screenHeight-rawHeight*(screenWidth/rawWidth))/2);else dimensions.l+=
Math.floor((screenWidth-rawWidth*(screenHeight/rawHeight))/2);else if(isRawImageTooWide)dimensions.t+=Math.floor((screenHeight-rawHeight*(screenWidth/rawWidth))/2);else if(isRawImageTooTall)dimensions.l+=Math.floor((screenWidth-rawWidth*(screenHeight/rawHeight))/2);else{dimensions.w=rawWidth;dimensions.h=rawHeight;dimensions.t+=Math.floor((screenHeight-rawHeight)/2);dimensions.l+=Math.floor((screenWidth-rawWidth)/2)}var $modal=$('\x3cdiv class\x3d"modal-content modal-image-in-focus"\x3e\x3ci class\x3d"inline-content-img-full-close close"\x3e\x26#215;\x3c/i\x3e\x3cimg alt\x3d"" src\x3d"'+
src+'" class\x3d"modal-closer zoom-out" style\x3d"max-width:'+dimensions.w+"px;max-height:"+dimensions.h+'px;"/\x3e\x3c/div\x3e');$("body").append($modal);$modal.jqm({overlayClass:"overlay-image-in-focus",overlay:100,closeClass:"modal-closer",trigger:false,onShow:function(obj){obj.o.prependTo("body");obj.w.css({"margin-top":dimensions.t+"px","margin-left":dimensions.l+"px"}).fadeIn("1000");$w.on("scroll."+modalClass,function(ev){$modal.jqmHide()});$d.on("keyup."+modalClass,function(ev){if(ev.which==
27)$modal.jqmHide()});$(obj.w).find(".inline-content-img-full-close").on("click."+modalClass,function(ev){$modal.jqmHide()});$(".modal-image-in-focus").addClass("zoom-out")},onHide:function(obj){obj.w.fadeOut("500");obj.o.fadeOut("1500",function(){obj.o.remove()});$w.off("scroll."+modalClass);$d.off("keyup."+modalClass);$(obj.w).find(".inline-content-img-full-close").off("click."+modalClass);$(".modal-image-in-focus").removeClass("zoom-out")}});$img.on("click.modal",function(){$modal.jqmShow()})})}})};
var activateSidebar=function(){if(!sidebarActivated){sidebarActivated=true;handleScrollAndResize();var scroller=function(){handleScrollAndResize();resizeImages()};$window.scroll(scroller);$window.resize(scroller);for(var i=0;i<toRemove.length;i++)toRemove[i].remove();toRemove=[];debug("Activate sidebar (done)")}};var addSnippetToSidebar=function(selector){debug("Save initial scroll position");initialScroll=$body.scrollTop();debug("Finding new snippet");var div=article.find(selector);if(div.length==
0)return;debug("Removing signup form");signup.detach();debug("Emptying container");if(!devmode)container.empty();debug("Cloning content");var newdiv=div[0].cloneNode(true);newdiv.id=div[0].id+"-clone";debug("Adding content to container");container.prepend(newdiv);container.prepend(closer);debug("Instrumenting external links");$(newdiv).find("a").each(function(idx,a){$a=$(a);$a.attr("target","_blank");var href=$a.attr("href");href=updateUrlParam(href,"tid",selector.replace(/^#/,"").replace(/[^\w]/g,
"-"));$a.attr("href",href);$a.click(function(){trackEvent(href,"external")})});debug("Update image URLs");$(newdiv).find("img").each(function(idx,img){$img=$(img);$img.data("origsrc",$img.attr("src"))});resizeImages(true);if(div[0].className.match(/\kmap-series/)){debug("Re-adding signup");container.append(signup)}};var trackEvent=function(target,name){$.post("https://recommendation-hybrid.wpdigital.net/hybrid/hybrid-filter/kmapevent",{start:start,elapsed:Date.now()-start,event:name,target:target,
svi:sviFull,pr:pr,darwin:!!darwin,omniture:!!(window.s&&window.s.sendDataToOmniture),abdarwin:abdarwin,abvariant:abvariant||"default",location:document.location.toString(),logs:logs.join("\n")});if(name=="click"&&window.s&&window.s.sendDataToOmniture)try{s.sendDataToOmniture("Knowledge Map Click","event80",{eVar26:target})}catch(e){}};var trackVisibility=function(elem){VisSense(elem).monitor({visible:function(){var target=$(elem).attr("data-id");if(!visibility[target]){visibility[target]=true;trackEvent(target,
"visible")}}}).start()};var linkClicked=function(ev){debugGroupStart("Link clicked");debug("Activate sidebar");activateSidebar();debug("Setting selected class");article.find(selector+".selected").removeClass("selected");$(this).addClass("selected");debug("Emptying the sidebar");if(!devmode)ad.remove();footer.remove();closer.detach();debug("Finding data target");var target=$(this).attr("data-id");debug("Adding snippet to sidebar");addSnippetToSidebar("#"+target);debug("Showing container");container.addClass("visible");
debug("Handling body scroll");handleBodyscroll();debug("Tracking click");trackEvent(target,"click");debug("Adding new content (done)");debugGroupEnd()};var closerClicked=function(){$html.removeClass("kmapnoscroll");$body.scrollTop(initialScroll);closer.addClass("closing");container.addClass("closing");setTimeout(function(){closer.removeClass("closing");container.removeClass("closing");container.removeClass("visible")},250);article.find(selector+".selected").removeClass("selected")};var updateURL=
function(){var newurl=null;var loc=document.location.toString();var replace=window.history&&window.history.replaceState;if(replace){if(!/[?&#]kmap=1/.test(loc)){if(!/\?/.test(loc))newurl=loc.replace(/#.*/,"")+"?kmap\x3d1";else newurl=loc.replace(/#.*/,"")+"\x26kmap\x3d1";var idx=newurl.indexOf(document.location.pathname);history.replaceState({},"",newurl.substr(idx))}}else if(!/[?&#]kmap=1/.test(loc))document.location=loc.replace(/#.*/,"")+"#kmap\x3d1"};var setupSignup=function(){if(window.localStorage&&
localStorage.getItem("kmap-signup")){localStorage.removeItem("kmap-signup");var modal=$("#knowledge-map-signup-modal").detach();$body.append(modal);modal=modal.jqm({closeClass:"kmap-follow-modal-close"});modal.jqmShow()}signup=$("#knowledge-map-signup").detach();signup.find("input[name\x3dredirect]").attr("value",document.location.toString());signup.find("form").submit(function(){this.action=this.action.replace(/https/,"http");document.cookie="kmap-signup\x3d1"+";max-age\x3d"+3600*24*365+";expires\x3d"+
(new Date(Date.now()+3600*24*365*1E3)).toUTCString();if(window.localStorage)localStorage.setItem("kmap-signup",true)})};var setupSharelinks=function(){var sharer=function(element,elementObject,socialUrl,shareUrlLong,socialUrl2,style){var shareUrl="";var currentURL="";if(abvariant=="experiment"&&pr)currentURL="http://wapo.st/1RBmkx6";else if(abvariant=="experiment")currentURL="http://wapo.st/1HQVI0e";else currentURL="http://wapo.st/1K9YhkM";if(socialUrl.match(/mailto/)){shareUrl="mailto:?subject\x3d"+
encodeURIComponent(document.title);shareUrl=shareUrl+"\x26body\x3d"+encodeURIComponent(currentURL);window.location.href=shareUrl}else if(socialUrl.match(/whatsapp/)){shareUrl="whatsapp://send?text\x3d"+encodeURIComponent(document.title);shareUrl=shareUrl+" - "+encodeURIComponent(currentURL);window.location.href=shareUrl}else if(socialUrl.match(/twitter/)){shareUrl=socialUrl+encodeURIComponent(currentURL)+"\x26text\x3d"+encodeURIComponent(document.title);window.open(shareUrl,"share",style)}else{shareUrl=
socialUrl+encodeURIComponent(currentURL);window.open(shareUrl,"share",style)}return false};$(".top-sharebar-wrapper a, .social-tools-wrapper-bottom a").each(function(idx,item){if(item.postShare&&item.postShare.callPostShare)item.postShare.callPostShare=sharer})};init=function(){updateURL();$(".pb-f-article-article-body").addClass("kmap");article.find(".kmap-themes").addClass("active");var triggers=article.find(selector).addClass("active");triggers.click(linkClicked);triggers.each(function(idx,elem){trackVisibility(elem)});
closer=$("#kmap-modal-closer").detach();closer.click(closerClicked);setupSignup();var marker=$("#knowledge-map-sidebar");sidebar=marker.parent().parent();container=marker.parent();marker.remove();ad=sidebar.find(".pb-f-ad-flex");footer=sidebar.find(".pb-f-page-footer-v2");if(!devmode)addSnippetToSidebar(".kmap-snippet.kmap-series");if(window.innerWidth>768)container.addClass("visible");children=sidebar.children();for(var i=0;i<children.length;i++){var box=$(children[i]);if(!box.hasClass("pb-f-ad-flex")&&
!box.hasClass("pb-f-page-footer-v2")&&!box.hasClass("pb-f-knowledge-map-knowledge-map"))if(!devmode)box.remove();else if(!/pf-f-ad/.test(children[i].className))toRemove.push(box)}setTimeout(setupSharelinks,500)};initNoKmap=function(){setupSignup();$("#signup-box-rr").empty().append(signup).show();article.find(selector).each(function(idx,elem){trackVisibility(elem)})}})(jQuery,wp_pb);
(function($){window.__e=window.__e||[];window._dw=window._dw||[];var feature={initABTest:function(){var self=this;window._dw.push(["global","ready",function(api){var variant=api.get("article-mostReadOpinion"),DEBUG=false;if(DEBUG||variant.is("replaceTwo")||variant.is("addTwo")){var x=2,normalSel="li.pm-content",addlSel="li.pm-addl-content";document.querySelectorAll(".pb-f-page-post-most ul.skin").forEach(function(ulInDom){if(ulInDom.querySelector(addlSel)){var source=ulInDom.cloneNode(true),target=
document.createElement("ul");if(!DEBUG&&variant.is("replaceTwo"))self.helpers._removeX(source,normalSel,x);else if(!DEBUG&&variant.is("addTwo"));else if(DEBUG);self.helpers._dedup(source);self.helpers._addX(source,target,normalSel);self.helpers._addX(source,target,addlSel,x);self.helpers._cleanLastClass(target);self.helpers._cleanDisplayNumbers(target);self.helpers._updateTids(target);ulInDom.innerHTML=target.innerHTML}})}}])},helpers:{_removeX:function(source,sel,x){var els=source.querySelectorAll(sel),
l=els.length;x=x===undefined?l:isNaN(x)||x<0?0:x>l?l:x;for(var i=0;i<x;i++){var child=source.children[l-x];if($(child).is(sel))source.removeChild(child)}},_addX:function(source,target,sel,x){var els=source.querySelectorAll(sel),l=els.length;x=x===undefined?l:isNaN(x)||x<0?0:x>l?l:x;els.forEach(function(el,i){if(i<x){$(el).removeClass("hide");target.append(el)}})},_cleanLastClass:function(el){var children=el.children,l=children.length;for(var i=0;i<l;i++)if(i==l-1)$(children[i]).addClass("last");else $(children[i]).removeClass("last")},
_cleanDisplayNumbers:function(el){var children=[],sel="#select-nothing-yKQcvflTRB";if(el.querySelector(".pm-addl-content .totalShown")){children=el.children;sel=".totalShown"}else if(el.querySelector(".pm-addl-content .thisTotalShown")){children=el.querySelectorAll(".pm-addl-content .thisTotalShown");sel=".thisTotalShown"}var l=children.length;for(var i=0;i<l;i++){var child=children[i];if($(child).is(".pm-addl-content"))try{child.querySelector(sel).innerHTML=i+1}catch(e){}}},_updateTids:function(el){var re=
/((\?|&)tid=[^&]+)/;el.querySelectorAll("a").forEach(function(a){if(a.href.match(re))a.href=a.href.replace(re,RegExp.$1+"_test")})},_dedup:function(target){var hrefs={},ul=document.createElement("ul");Array.prototype.filter.call(target.querySelectorAll("li"),function(li){var href=li.querySelector("a[href]").getAttribute("href").split("?")[0];if(href in hrefs)return false;else{hrefs[href]=true;return true}}).forEach(function(li){ul.append(li)});target.innerHTML=ul.innerHTML}},initSubscribe:function(){if(wp_pb&&
wp_pb.StaticMethods&&!wp_pb.StaticMethods.isSubscriber())$(".pb-mostread-subscribe").show()},init:function(){this.initABTest();this.initSubscribe()}};var lifecycle={init:function(){feature.init()}};if(wp_pb.StaticMethods.isPageHydrated())lifecycle.init();window.__e.push(["shamble",function(){lifecycle.init()}])})(jQuery);
(function($){var __e=window.__e||[],logger=!!window.TWP&&!!TWP.Tools&&!!TWP.Tools.logger?new TWP.Tools.logger("pb-f-article-article-body"):window.console;var deviceWidth=window.innerWidth>0?window.innerWidth:screen.width;function Newsletter(){var defaultNewsLetter={frequency:"Daily",headline:"Get the Today's Headlines Newsletter",id:"post_newsletter1",name:"Today's Headlines",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-heads",variable:"vars[intent_heads]"},defaultNewsLetters=
[{frequency:"Daily",headline:"Get the Today's Headlines Newsletter",id:"post_newsletter1",name:"Today's Headlines",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-heads",variable:"vars[intent_heads]"},{frequency:"Daily",headline:"Get the Read In Newsletter",id:"post_newsletter112",name:"Read In",tagline:"Free daily updates delivered just for you.",template:"signup-confirm-readin",variable:"vars[intent_readin]"},{frequency:"Weekly",headline:"Get the Lean \x26 Fit Newsletter",
id:"post_newsletter8",name:"Lean \x26 Fit",tagline:"Free weekly updates delivered just for you.",template:"signup-confirm-lean",variable:"vars[intent_lean]"},{frequency:"Twice-weekly",headline:"Get the Checkpoint Newsletter",id:"post_newsletter130",name:"Checkpoint",tagline:"Free twice-weekly updates delivered just for you.",template:"signup-confirm-check",variable:"vars[intent_check]"}],subscribeEmail,washPostId,showNewsletter=function(){$("#signup-box-rr").show()},hideNewsletter=function(){$("#signup-box-rr").hide()},
showSignUpForm=function(){$("#newsletter-signUp-form").show();$("#newsletter-signUp-button").hide()},showSignUpButton=function(){$("#newsletter-signUp-form").hide();$("#newsletter-signUp-button").show()},showErrorMessage=function(message){if(message)$(".newsLetter-error-msg").text(message).show()},hideErrorMessage=function(){$(".newsLetter-error-msg").hide()},setNewsLetterValue=function(data){$("#newsletter-headline").append(data.headline);$("#newsletter-tagline").text(data.blurb)},setRecommendationsValues=
function(data){$(".suggestion-list .recommended").each(function(index){$(this).find("p").text(data[index].headline);$(this).find("input[type\x3d'checkbox']").attr("value",data[index].id);$(this).find("input[type\x3d'checkbox']").attr("name",data[index].name)})},toggleRecommendations=function(show){if(show){$("#newsletter-signUp-form, #newsletter-signUp-button, #newsletter-tagline").hide();$("#newsletter-suggestions-rr, #headline-checked, #subscribed-confirmation, #all-newsletters-lbl").show()}else $("#newsletter-suggestions-rr").hide()},
showSignUpConfirmation=function(){$("#newsletter-signUp-form, #newsletter-signUp-button, #newsletter-tagline").hide();$("#headline-checked, #subscribed-confirmation, #all-newsletters-lbl").show()},getUserId=function(){return document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:""},getWapoId=function(){return document.cookie.match(/wapo_secure_login_id=([^;]+)/)?RegExp.$1:""},getPageData=function(){var section=$("#newsletter-section").text(),subSection=$("#newsletter-subsection").text(),blog=$("#newsletter-blogname").text(),
data={};washPostId=getUserId();if(washPostId!=="")data.washPostId=washPostId;if(blog)data.blog=blog;if(subSection)data.subSection=subSection;if(section)data.section=section;return data},getMainNewsletter=function(){var data=getPageData();return $.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"https://recommendation-newsletter.wpdigital.net/Newsletter/api/newsletter",data:JSON.stringify(data)})},getRecommendations=function(newsletters){var data=getPageData();data.newsletters=
newsletters;return $.ajax({type:"POST",dataType:"json",contentType:"application/json",url:"https://recommendation-newsletter.wpdigital.net/Newsletter/api/newsletters",data:JSON.stringify(data)})},subscribe=function(email,recaptchaToken){var data,url;if(washPostId!==""){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe";data={wapoLoginID:washPostId,wapoSecureID:getWapoId(),userAgent:navigator.userAgent,newsletterName:window.Newsletter.id,metadata:[{name:"nl_start_method",value:"EI"},
{name:"nl_start_location",value:"RR"}]};if(recaptchaToken)data["recaptchaResponse"]=recaptchaToken}else if(email){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-email";data={email:email,newsletterName:window.Newsletter.id,metadata:[{name:"nl_start_method",value:"EI"},{name:"nl_start_location",value:"RR"}]};if(recaptchaToken)data["recaptchaResponse"]=recaptchaToken}$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status==
"SUCCESS"){sendCustomTrackProps("event91",trackProps(window.Newsletter.name,1,"simple"),"Newsletter Right Rail Sign-up");setUpRecommendations(window.Newsletter.id)}},error:function(request,status,error){logger.info(error,"Error while subscribing")}})},subscribeBundle=function(){var data,url,newsletters=[],newsletterNames=[];$("#newsletter-suggestions-rr input:checked").each(function(){newsletters.push($(this).val());newsletterNames.push({name:$(this).attr("name"),position:$(this).attr("data-pos")})});
if(newsletters.length>0&&newsletterNames.length>0){if(washPostId!==""){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-list";data={wapoLoginID:washPostId,wapoSecureID:getWapoId(),userAgent:navigator.userAgent,newsletters:newsletters,metadata:[{name:"nl_start_method",value:"EA"},{name:"nl_start_location",value:"RR"}]}}else if(subscribeEmail){url="https://subscribe.washingtonpost.com/person/newsletter/subscribe-list-email";data={email:subscribeEmail,newsletters:newsletters,metadata:[{name:"nl_start_method",
value:"EA"},{name:"nl_start_location",value:"RR"}]}}$.ajax({type:"POST",dataType:"json",contentType:"application/json",url:url,data:JSON.stringify(data),success:function(data){if(data.status=="SUCCESS"){for(var i=0;i<newsletterNames.length;i++)sendCustomTrackProps("event91",trackProps(newsletterNames[i].name,newsletterNames[i].position,"enhanced"),"Newsletter Right Rail Sign-up Bundle");setUpRecommendations(newsletters,true);toggleRecommendations(false)}},error:function(request,status,error){logger.info(error,
"Error while subscribing bundle")}})}},setUpRecommendations=function(newsletterId,confirmBundleSubscribe){var recommendations=getRecommendations([window.Newsletter.id]);recommendations.done(function(data){if(!$.isEmptyObject(data.newsletters)&&data.newsletters.length>=3&&!confirmBundleSubscribe){window.Newsletters=data.newsletters;setRecommendationsValues(data.newsletters);toggleRecommendations(true)}else toggleRecommendations(false);showSignUpConfirmation()});recommendations.fail(function(){if(!confirmBundleSubscribe){window.Newsletters=
defaultNewsLetters;setRecommendationsValues(defaultNewsLetters);toggleRecommendations(true)}})},setUpMainNewsletter=function(newsletter){window.Newsletter=newsletter;setNewsLetterValue(newsletter);showNewsletter();if(getUserId()!=="")showSignUpButton();else showSignUpForm()},applyRrNewsletters=function(){var mainNewsletter=getMainNewsletter();mainNewsletter.done(function(data){if(!$.isEmptyObject(data.newsletter))setUpMainNewsletter(data.newsletter);else hideNewsletter()});mainNewsletter.fail(function(){setUpMainNewsletter(defaultNewsLetter);
sendCustomTrackProps("event50",trackProps(defaultNewsLetter.name,1),"Newsletter Right Rail API failure case")});$("#newsletter-signUp-form").on("mouseover",function(){if(typeof grecaptcha==="undefined")$.ajax({url:"https://www.google.com/recaptcha/api.js",dataType:"script",cache:true,success:function(){var findCaptcha=setInterval(function(){if(typeof grecaptcha!=="undefined")clearInterval(findCaptcha)},50)},error:function(){}})});var captchaId;var email;var resetCaptcha=function(){if(captchaId)grecaptcha.reset();
$("#nlrecaptchadiv").html("");captchaId=grecaptcha.render("nlrecaptchadiv",{sitekey:"6Lf0DRoUAAAAAEawkoNEUKcpWx8eh_I7PRArTA9V",size:"invisible",callback:function(resp){logger.info("response key \x3d "+grecaptcha.getResponse(captchaId));$("#captchaDiv .text-success").show();setTimeout(function(){$("#captchaDiv .text-success").hide();$("#captchaDiv").hide()},5E3);subscribe(email,resp)}})};var captchaInitialized=0;$("#newsLetter-input").click(function(){if(!captchaInitialized){captchaInitialized=1;resetCaptcha($(this).html())}});
$(".subscribe-newsLetter").click(function(){var re=/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/gim;subscribeEmail=$("#newsLetter-input").val();if(this.id!=="newsletter-signUp-button"&&(subscribeEmail==""||!re.test(subscribeEmail)))showErrorMessage("Please enter a valid email address");else{hideErrorMessage();email=subscribeEmail;if(washPostId!=="")subscribe(subscribeEmail);else grecaptcha.execute(captchaId)}return false});$("#subscribe-bundle").click(function(){subscribeBundle()});$("#cancel-bundle").click(function(){sendCustomTrackProps("event58",
trackProps(),"No Thanks, Newsletter Right Rail Sign-up Bundle");$("#newsletter-suggestions-rr, #subscribed-confirmation").hide()})};function trackProps(newsletterName,index,enhancedKey){var subsection=window.wp_subsection||"";var contentType=window.wp_content_type||"";var channel=window.wp_channel||"";var props={eVar2:"wp - "+subsection,prop2:"wp - "+subsection,prop3:contentType,eVar17:contentType,channel:channel};if(newsletterName&&index)props.eVar26="nl_rightrail_"+enhancedKey+"_"+newsletterName.toLowerCase().split(" ").join("-")+
"_"+index;return props}function sendCustomTrackProps(eventKey,props,name){if(!!window.s)window.s.sendDataToOmniture(name||"PB Feature - Page-Newsletter",eventKey,props,{wait:true})}function initABTest(){var _dw=window._dw||[];_dw.push(["global","ready",function(api){if(deviceWidth>460)if(window.TWP.Data.Tracking.props.content_type=="front")applyRrNewsletters();else if(window.TWP.Data.Tracking.props.content_type=="blog"||window.TWP.Data.Tracking.props.content_type=="article"){var variant=api.get("newsletters-articleUnits");
if(!variant.is("banner")&&!variant.is("bottom"))applyRrNewsletters(variant)}else applyRrNewsletters()}])}this.init=function(){initABTest()}}var lifecycle={init:function(){var nl=new Newsletter;nl.init()}};if(wp_pb.StaticMethods.isPageHydrated())lifecycle.init();__e.push(["shamble",function(){lifecycle.init()}])})(jQuery);
(function($){try{function cleanUp(){$("li","#editors-picks-rr").each(function(i){var $this=$(this);var $headline=$(".headline",$this);var $number=$(".number",$this);var lineHeight=parseInt($headline.css("lineHeight"));if($headline.height()<=2*lineHeight)$headline.css({"padding-top":"7px","padding-bottom":"8px"});else if($headline.height()>3*lineHeight)while($headline.height()>3*lineHeight){$headline.text($headline.text().replace(/\.\.\.$/,""));$headline.text($headline.text().slice(0,-1));$headline.text($headline.text()+
"...")}})}cleanUp()}catch(e){}})(jQuery);
(function($,TWP){var applyStickiness=function(){var $window=$(window),$ad=$(".pb-f-ad-flex-3"),$nextStory=$(".pb-f-article-next-story"),$bottomContent=$("#bottom-content"),$rightRail=$("#right-rail"),slotId="slug_flex_ss_bb_hp_3",stopLimit=0,$prevSibling=$ad.prev();if(!$rightRail.length&&$prevSibling.children().length)$rightRail=$prevSibling;$(document).on("async-features-loaded",function(){$prevSibling=$ad.prev()});$ad.on("DOMNodeInserted",function(e){var $el=$(e.target),id=$el.attr("id");if($el.is("iframe")&&
id&&!/(hidden)/g.test(id)){$ad.off("DOMNodeInserted");afterAdInserted($el)}});var bindScrollDown=function(){var original_top=$ad.offset().top,scrollTop,ad_left=$rightRail.offset().left,adWidth=$rightRail.width(),min_left=618;var getStopPoint=function(){var leaderboardAdTop=$bottomContent.length?$bottomContent.offset().top:$(document).height();var featureTop=$nextStory.is(":visible")?$nextStory.offset().top:leaderboardAdTop;return featureTop-$ad.height()-50}();var getTopPoint=function(){if($prevSibling.length)return $prevSibling.offset().top+
$prevSibling.height();else return original_top};var applySticky=function(scrollTop){var stopPoint=getStopPoint;stopLimit=stopLimit?stopLimit:stopPoint+$ad.height()+50;if(scrollTop>stopPoint){if($ad.hasClass("sticky")){$ad.removeClass("sticky");var topPoint=stopPoint-$ad.height()/2;$ad.css({top:topPoint,left:0,position:"absolute"})}}else if(scrollTop<stopPoint+$ad.height()+50)if(!$ad.hasClass("sticky")&&ad_left>min_left){$ad.css({top:50,left:ad_left,width:adWidth,position:"initial"});$ad.addClass("sticky")}};
var removeSticky=function(){if($ad.hasClass("sticky")){$ad.attr("style","");$ad.removeClass("sticky")}};$window.off("scroll.flexAd3-sticky").on("scroll.flexAd3-sticky",function(){scrollTop=$window.scrollTop();if(scrollTop>getTopPoint())applySticky(scrollTop);else removeSticky()});$window.off("resize.flexAd3-sticky").on("resize.flexAd3-sticky",function(){ad_left=$rightRail.offset().left;if($ad.is(":visible")&&$ad.hasClass("sticky"))if(ad_left>min_left)$ad.css({left:ad_left});else removeSticky()});
$ad.on("flexAd3.remove_sticky",function(){$window.off("scroll.flexAd3-sticky");$window.off("resize.flexAd3-sticky");removeSticky()})};function startSticky(){if(!TWP.Features.Ad.flexAd3.sticky)return;if($ad.is(":visible"))bindScrollDown();else $window.on("resize.flexAd3-invisible",function(){if($ad.is(":visible"))bindScrollDown();else $ad.trigger("flexAd3.remove_sticky")})}var afterAdInserted=function(){if(window.googletag&&window.googletag.pubadsReady)window.googletag.pubads().addEventListener("slotRenderEnded",
function(event){if(event.slot.getSlotElementId()===slotId)startSticky()})}};if(TWP.Features.Ad.flexAd3&&TWP.Features.Ad.flexAd3.sticky)applyStickiness()})(jQuery,TWP);
(function($){TWP=window.TWP||{};TWP.PostTV=TWP.PostTV||{};TWP.PostTV.StickyPlayer=TWP.PostTV.StickyPlayer||{};window.stickyEngagedTimeStamp=null;var $rootFixed=TWP.PostTV.StickyPlayer.$rootFixed;var playerOutId;var mobileMode=window.isMobile&&window.isMobile.any()||window.location.href.indexOf("forceMobileMode")>-1;function animateTo($anchor,opts){var options=opts||{};options.fixed=options.fixed||false;options.zIndex=options.zIndex||1;options.shadow=options.shadow||false;options.speed=options.speed||
400;options.cb=options.cb||null;var relativeTofixed=function($anchor,cb){var $fixed=$rootFixed,fixedOffset=$fixed.offset(),fixedWidth=$fixed.width(),anchorOffset=$anchor.offset(),anchorWidth=$anchor.width(),scrollTop=$(window).scrollTop();$fixed.css({position:"fixed",top:fixedOffset.top-scrollTop,left:fixedOffset.left,width:fixedWidth+"px","z-index":options.zIndex});$fixed.css({"transition-duration":options.speed/1E3+"s","transition-timing-function":"ease-in-out",width:anchorWidth+2+"px",top:anchorOffset.top-
$(window).scrollTop(),left:anchorOffset.left});if(typeof cb==="function")$fixed.one("transitionend",cb);$fixed.find(".wpv-sticky").addClass("wpv-sticky-engaged")};var fixedToRelative=function($anchor,cb){var $fixed=$rootFixed,offset=$anchor.offset(),width=$anchor.width(),scrollTop=$(window).scrollTop();var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement,isFullscreen=fullscreenElement!==null&&typeof fullscreenElement!=="undefined";var transitionStyles=
{width:width,top:offset.top-scrollTop,left:offset.left,"z-index":""};var toRelativeStyles={"transition-duration":"","transition-timing-function":"",position:"relative",top:"",left:"",width:"100%"};if(isFullscreen){$fixed.css(transitionStyles).css(toRelativeStyles);if(typeof cb==="function")cb();return}$fixed.css(transitionStyles);$fixed.one("transitionend",function(){$fixed.css(toRelativeStyles);if(typeof cb==="function")cb()});$fixed.find(".wpv-sticky").removeClass("wpv-sticky-engaged")};var animate=
function($anchor,cb){if(options.fixed)relativeTofixed($anchor,cb);else fixedToRelative($anchor,cb)};var cb=function(){if(typeof options.cb==="function")options.cb()};animate($anchor,cb)}var $root=$(".pb-f-posttv-sticky-player-powa"),$subRoot=$root.find(".posttv-sticky-player-video"),$vidWrapper=$root.find(".posttv-sticky-player-wrapper"),$textEl=$root.find(".posttv-sticky-player-text"),$caption=$root.find(".posttv-sticky-player-caption");function usePowaSticky(){TWP.PostTV.StickyPlayer.showPlayer=
function(){$subRoot.removeClass("wpv-hidden");window.setTimeout(function(){$stickyClose.removeClass("wpv-hidden")},2E3)};TWP.PostTV.StickyPlayer.hidePlayer=function(){$subRoot.addClass("wpv-hidden");$stickyClose.addClass("wpv-hidden")};TWP.PostTV.StickyPlayer.showText=function(){$textEl.removeClass("wpv-hidden")};TWP.PostTV.StickyPlayer.hideText=function(){$textEl.addClass("wpv-hidden")};TWP.PostTV.StickyPlayer.updateBlurb=function(newBlurb){$caption.html(newBlurb)}}var adjustSize=function(){var widthRatio=
.3;if(mobileMode&&window.matchMedia("(orientation: portrait)").matches)widthRatio=.6;var stickyWidth=$(window).width()*widthRatio+12;if(stickyWidth>492)stickyWidth=492;else if(stickyWidth<156)stickyWidth=156;$root.css({width:stickyWidth});$vidWrapper.css({width:stickyWidth-12});$vidWrapper.css({height:$vidWrapper.width()*9/16})};adjustSize();function isElementInViewport(el,fract){if(typeof jQuery==="function"&&el instanceof jQuery)el=el[0];var fraction=fract||.8;var rect=el.getBoundingClientRect();
var topOffsetAdjustment=0;var $navBarEl=$("#nav-bar");var $breakingNewsEl=$(".pb-f-page-breaking-news-bar");if($navBarEl.length>0)topOffsetAdjustment+=$navBarEl.height();if($breakingNewsEl.length>0)topOffsetAdjustment+=$breakingNewsEl.height();return rect.top+el.offsetHeight*fraction>=topOffsetAdjustment&&rect.left>=0&&rect.bottom-el.offsetHeight*fraction<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)||rect.top<0&&
rect.bottom>(window.innerHeight||document.documentElement.clientHeight)}function isMobileAndZoomedIn(){if(window.isMobile&&window.isMobile.any()){var ratio=document.documentElement.clientWidth/window.innerWidth;return ratio>1}return false}function getBottomIframe(){var toReturn;try{toReturn=document.getElementById("slug_fixedBottom").getElementsByTagName("iframe")[0]}catch(e){}return toReturn}function showPOEToggle(){try{$(getBottomIframe().contentWindow.document.querySelector("#poe-toggle")).show()}catch(e){}}
function hidePOEToggle(){try{$(getBottomIframe().contentWindow.document.querySelector("#poe-toggle")).hide()}catch(e){}}function goFullscreen($powaEl){var isFullScreen=!!(document.fullScreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement);var powaEl=$powaEl[0];var videoEl=$powaEl.find(".powa-video")[0];var fullscreenEl=videoEl;if($powaEl.find(".powa-live-video-controls").length>0)fullscreenEl=powaEl;if(!isFullScreen)if(fullscreenEl.requestFullscreen)fullscreenEl.requestFullscreen();
else if(fullscreenEl.mozRequestFullScreen)fullscreenEl.mozRequestFullScreen();else if(fullscreenEl.webkitRequestFullScreen)fullscreenEl.webkitRequestFullScreen();else if(fullscreenEl.msRequestFullscreen)fullscreenEl.msRequestFullscreen();else if(videoEl.webkitEnterFullScreen)videoEl.webkitEnterFullscreen()}var $players=$(".powa");var throttleInterval=5;var waitInterval=400;var lastTime=(new Date).getTime();var isOut=false;var waitTimeout;var $target=$root.find("#posttv-sticky-player-wrapper");var $stickyClose=
$root.find(".posttv-sticky-player-exit");var outTracker=false;var closeTracker=false;var WAIT=false;function safetyCheck(cb){clearTimeout(waitTimeout);waitTimeout=setTimeout(function(){WAIT=true;cb&&cb()},waitInterval)}function moveOut(id,$el){wp_pb.report(id,"player_is_sticky");if(!outTracker)outTracker=true;window.stickyEngagedTimeStamp=Date.now();playerOutId=id;isOut=true;$root.removeClass("wpv-hidden");clearTimeout(waitTimeout);if(mobileMode)$root.addClass("bottom-60");if($target.get(0).style.display!=
"none")animateTo($el,{fixed:true,zIndex:536870903,cb:function(){if(isOut){TWP.PostTV.StickyPlayer.showPlayer();window.dispatchEvent(new Event("resize"))}}})}function moveBack($el,id){wp_pb.report(id,"player_is_not_sticky");TWP.PostTV.StickyPlayer.hidePlayer();safetyCheck(function(){animateTo($el,{cb:function(){window.dispatchEvent(new Event("resize"));WAIT=false}})});$root.addClass("wpv-hidden");isOut=false}function checkPlayers(){var $el=$($players.get(0));if($el.data("aspect-ratio")<.56||$el.data("aspect-ratio")>
.57)return true;var allowOnMobile=$el.attr("data-sticky-player-mobile")!=="0"||window.location.href.indexOf("mobileStickyPlayer")>-1;var allowedClient=window.isMobile&&window.isMobile.any()?allowOnMobile:true;if(!allowedClient)return true;var id=$el.attr("id");var player=window.powas&&window.powas[id];var $wrap=$el.parent().hasClass("wpv-wrap")?$el.parent():$el.parent().parent().hasClass("wpv-wrap")?$el.parent().parent():null;if($wrap&&player&&!closeTracker){var video=$el.find("video.powa-video");
var isPlaying=!video.paused&&video.currentTime>0||player&&player.powa.getStatus().playing;if(isMobileAndZoomedIn())$stickyClose.click();else if(isElementInViewport($wrap)&&isOut&&playerOutId===id){moveBack($wrap,id);if(mobileMode){$rootFixed.find(".powa-pane").show();showPOEToggle();$rootFixed.find(".powa-video").off(".stickyPlayerFullscreen")}}else if(!isElementInViewport($wrap)&&!isOut&&isPlaying){if(mobileMode){$rootFixed.find(".powa-pane").hide();if(!window.isMobile.iOS()){player.powa.hideControls();
if(player.powa.getStatus().state.startsWith("ad"))player.powa.once("play",player.powa.hideControls);var event=window.isMobile&&window.isMobile.any()?"touchstart.stickyPlayerFullscreen":"click.stickyPlayerFullscreen";$rootFixed.find(".powa-video").on(event,function(){var playerState=player.powa.getStatus().state;if(playerState==="playing"||playerState==="paused")goFullscreen($el)})}try{getBottomIframe().contentWindow.document.querySelector(".poe-container--expanded #poe-toggle").click()}catch(e){}hidePOEToggle()}moveOut(id,
$target)}}}function initEventHandlers(){$(window).scroll(throttle(function(){var time=(new Date).getTime();if(time-lastTime>throttleInterval&&!WAIT){lastTime=time;checkPlayers()}},50));$(window).resize(wp_pb.StaticMethods.debounce(function(){adjustSize();if(isOut&&playerOutId)animateTo($target,{fixed:true,speed:10,zIndex:536870903})},100));$stickyClose.click(function(){if(!closeTracker)closeTracker=true;showPOEToggle();try{window.powas[playerOutId].powa.pause();moveBack($("#"+playerOutId).parent().parent(),
playerOutId)}catch(err){}try{var playerEl=window.powas[playerOutId].powa.element;playerEl.dispatchEvent(new CustomEvent("stickyClose",{detail:Math.floor((Date.now()-window.stickyEngagedTimeStamp)/1E3)}))}catch(err){}})}function init(id){usePowaSticky();initEventHandlers();var $el=$("#"+id);$rootFixed=$rootFixed&&$rootFixed.length?$rootFixed:$el.parent(".wpv-fixed");if($el.data("aspect-ratio")<.56||$el.data("aspect-ratio")>.57)return;$players=$players.length?$players:$(".powa");$target=$target.length?
$target:$root.find("#posttv-sticky-player-wrapper");$stickyClose=$stickyClose.length?$stickyClose:$root.find(".posttv-sticky-player-exit");if($players[0]&&id===$players[0].id&&$el.attr("data-preroll-only")!=="1"&&$el.attr("data-sticky-player")!=="0")$el.addClass("wpv-sticky")}if(window.powas&&$players&&$players[0]&&$players[0].id&&window.powas[$players[0].id])init($players[0].id);else document.body.addEventListener("powaReady",function(event){init(event.detail.id)});$(function(){$root.addClass("wpv-hidden")});
function throttle(func,wait,options){var context,args,result;var timeout=null;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:Date.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null};return function(){var now=Date.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null}previous=now;
result=func.apply(context,args);if(!timeout)context=args=null}else if(!timeout&&options.trailing!==false)timeout=setTimeout(later,remaining);return result}}})(jQuery);
(function(window,$,TWP){var console=new TWP.Tools.logger("re-engage");$.fn.idle=function(options){var defaults={idle:6E4,events:"mousemove keydown mousedown touchstart",onIdle:function(){},onActive:function(){},onHide:function(){},onShow:function(){},keepTracking:true,startAtIdle:false,recurIdleCall:false},idle=options.startAtIdle||false,visible=!options.startAtIdle||true,settings=$.extend({},defaults,options),lastId=null,resetTimeout,timeout;$(this).on("idle:stop",{},function(event){$(this).off(settings.events);
settings.keepTracking=false;resetTimeout(lastId,settings)});resetTimeout=function(id,settings){if(idle){settings.onActive.call();idle=false}clearTimeout(id);if(settings.keepTracking)return timeout(settings)};timeout=function(settings){var timer=settings.recurIdleCall?setInterval:setTimeout,id;id=timer(function(){idle=true;settings.onIdle.call()},settings.idle);return id};return this.each(function(){lastId=timeout(settings);$(this).on(settings.events,function(e){lastId=resetTimeout(lastId,settings)});
if(settings.onShow||settings.onHide)$(document).on("visibilitychange webkitvisibilitychange mozvisibilitychange msvisibilitychange",function(){if(document.hidden||document.webkitHidden||document.mozHidden||document.msHidden){if(visible){visible=false;settings.onHide.call()}}else if(!visible){visible=true;settings.onShow.call()}})})};var ReEngageMonitor=function(){var callback;var direction="unknown";var lastDate=-1;var lastScrollTop=-1;var thisMinimumTrackingDelayInMs=250;function init(callbackMethod){callback=
callbackMethod;window.addEventListener("scroll.reEngage",function(e){e.preventDefault();var scrollTop=$(this).scrollTop();e.timeStamp=(new Date).getTime();didScroll(e.timeStamp,scrollTop)},true);$(window).on("scroll.reEngage",function(e){var scrollTop=$(this).scrollTop();e.timeStamp=(new Date).getTime();didScroll(e.timeStamp,scrollTop)});$(window).on("touchstart",function(e){var scrollTop=$(this).scrollTop();didScroll(e.timeStamp,scrollTop)})}function didScroll(timeStamp,scrollTop){if(lastDate+thisMinimumTrackingDelayInMs<=
timeStamp){var offset=Math.abs(scrollTop-lastScrollTop);var direction=getDirection(scrollTop);var delayInMs=timeStamp-lastDate;var speedInPxPerMs=offset/delayInMs;if(speedInPxPerMs>0)callback(speedInPxPerMs,timeStamp,direction);lastDate=timeStamp}}function getDirection(scrollTop){var currentScrollTop=lastScrollTop;lastScrollTop=scrollTop;if(currentScrollTop>-1){if(currentScrollTop>=scrollTop)return"up";return"down"}return"unknown"}function reset(){direction="unknown";lastDate=-1;lastScrollTop=-1}
return{init:init}}();var ReEngageScroller=function(){var direction="unknown";var jQueryElement=null;var targetHeight=$(document).height();var requiredSpeedInPxPerMs=2;var $storyContainer=null;function init(starOverlay,clickThru){jQueryElement=starOverlay;$storyContainer=starOverlay.find(".re-engage-secondary");$(document).on("click",".re-engage-close",function(event){if($(this).hasClass("fa-chevron-down")||$(this).hasClass("fa-remove")){shrinkScroller();trackingFeature("collapse","event80")}});$(document).on("click",
".js-re-engage-sm",function(event){growScroller();trackingFeature("expand","event80")});$(document).on("click",".re-engage-ad-close",function(event){hideBigLogo()});$(document).on("click",".re-engage-ad-sm",function(event){hideSmallLogo()});$("a.js-bc-click",jQueryElement).on("click",function(){pixelTracking(1)});ReEngageMonitor.init(function(speedInPxPerMs,timeStamp,newDirection){if(direction!=newDirection){jQueryElement.removeClass("up down").addClass(newDirection);direction=newDirection}var visible=
jQueryElement.is(":visible");if(requiredSpeedInPxPerMs<=speedInPxPerMs)if(jQueryElement.length&&!visible){$(".js-re-engage-click").on("click",function(event){event.preventDefault();window.open(clickThru)});if($("#floating-bb-content").length)return;disableAd();jQueryElement.css("opacity",1).fadeIn(3E3);if(TWP.Features.Page.ReEngage.isCarousel)repositionSlick($storyContainer);$(document).trigger("idle:stop");trackingFeature("show","event66");pixelTracking();$(window).off("scroll.reEngage")}})}function repositionSlick($storyContainer){if(!$storyContainer.hasClass("slick-initialized"))$storyContainer.on("init",
function(){$storyContainer.slick("setPosition")});else $storyContainer.slick("setPosition")}function shrinkScroller(){var min_height=$(".re-engage-big").data("min-height");$(".re-engage-big").animate({height:min_height+"px"},function(){$(this).addClass("js-re-engage-sm");$(this).find(".fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up")})}function growScroller(){var max_height=$(".re-engage-big").data("max-height");$(".re-engage-big").animate({height:max_height+"px"},function(){$(this).removeClass("js-re-engage-sm");
$(this).find(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down")})}function hideBigLogo(){$(".re-engage-ad-big").slideUp("slow",function(){$(".re-engage-ad-sm").slideDown("slow");jQueryElement.css("opacity",1)})}function hideSmallLogo(){$(".re-engage-ad-sm").slideUp("slow",function(){$(".re-engage-ad-big").slideDown("slow");jQueryElement.css("opacity",1)})}return{init:init}}();var ReEngageRendering=function(){var client,displayStoryNum;function _failure(){$(".re-engage-wrapper").remove();
$(window).off("scroll.reEngage")}function render(recommendations){if(!recommendations||recommendations.length===0)return _failure();var content="",$storyContainer=$(".re-engage-secondary"),recommendation;for(var i=0;i<recommendations.length;i++){recommendation=recommendations[i];if(i<displayStoryNum)content+=renderItem(recommendation,i)}if($storyContainer.length&&content){$storyContainer.html(content);trackClick($storyContainer);if(TWP.Features.Page.ReEngage.isCarousel){$storyContainer.slick({arrows:true,
rtl:false});$storyContainer.on("afterChange",function(event,slick,currentSlide,nextSlide){var eVar26="swipe-"+currentSlide;trackingFeature(eVar26,"event80")})}}}function renderItem(recommendation,index){var img='\x3cimg alt\x3d"" src\x3d"'+renderImgURL(recommendation,75,75)+'"'+' data-hi-res-src\x3d"'+renderImgURL(recommendation,75,75)+'"'+' data-low-res-src\x3d"'+renderImgURL(recommendation,75,75)+'"'+' data-threshold\x3d"112" class\x3d"re-engage-photo"\x3e';return'\x3cdiv class\x3d"re-engage-recommend"\x3e\x3ca href\x3d"'+
recommendation.url+"?tid\x3da_reengage-"+index+'" class\x3d"re-engage-text-link"\x3e'+img+'\x3cdiv class\x3d"re-engage-headline"\x3e'+recommendation.headline+"\x3c/div\x3e\x3c/a\x3e\x3c/div\x3e"}function renderImgURL(recommendation,w,h){var url=recommendation.photo.path;return"https://www.washingtonpost.com/wp-apps/imrs.php?src\x3d"+encodeURIComponent(url)+"\x26w\x3d"+w+"\x26h\x3d"+h}function trackClick($storyContainer){$storyContainer.on("click","a",null,function(ev){var link=this,href=link.href;
client.clicked(href);setTimeout(function(){document.location=href},200);return false})}function trackDisplay(){client.rendered()}function preload(){displayStoryNum=1;if(TWP.Features.Page.ReEngage.isCarousel)displayStoryNum=3;client=new TWP.Perso.Recommend("re-engage-v1",displayStoryNum);client.recommend().done(function(data){render(data["results"])}).fail(_failure)}return{preload:preload,trackDisplay:trackDisplay}}();var enableReEngage=function(){var $scrollStars=$(".re-engage-wrapper"),$closeIcon=
$(".re-engage-close");if($scrollStars.length&&wp_pb.BrowserInfo.mobile_browser&&!wp_pb.BrowserInfo.tablet){TWP.Features.Page.ReEngage.isCarousel?$closeIcon.addClass("fa-remove"):$closeIcon.addClass("fa-chevron-down");var idleTimeInMiliseconds=18E3;console.log("Inactive start");$(document).idle({onIdle:function(){console.log("Showing re-engage");var $engageElm=$(".re-engage-wrapper");disableAd();if($engageElm.length&&!$engageElm.is(":visible")&&!$("#floating-bb-content").length){$(document).trigger("idle:stop");
$engageElm.css("opacity",1).fadeIn(1500);if(TWP.Features.Page.ReEngage.isCarousel)$(".re-engage-secondary").slick("setPosition");trackingFeature("show","event66");pixelTracking()}},events:"mousemove keydown mousedown touchstart scroll",idle:idleTimeInMiliseconds});ReEngageScroller.init($scrollStars)}};var disableAd=function(){var $bottomAd=$("#slug_fixedBottom");if($bottomAd.length)$bottomAd.remove();else $("body").on("DOMNodeInserted",function(e){var $el=$(e.target),id=$el.attr("id");if($el.is("div")&&
id&&id==="slug_fixedBottom")$el.remove()})};var trackingFeature=function(ev,eNum){if(typeof window.sendDataToOmniture==="function"){var eventName="reengage-"+ev,varName="a_reengage-"+ev,subsection=window.wp_subsection;if(subsection.indexOf("wp")<0)subsection="wp - "+subsection;var data={pageName:window.wp_page_name,eVar1:window.wp_page_name,prop2:subsection,eVar2:window.wp_channel,prop3:window.wp_content_type,eVar17:window.wp_content_type,eVar26:varName};sendDataToOmniture(eventName,eNum,data)}};
var pixelTracking=function(isClicked){var axel=Math.random()*1E13,trackingPixel=document.createElement("img");trackingPixel.style.cssText="width:1px;height:1px";if(isClicked)trackingPixel.src="https://pubads.g.doubleclick.net/gampad/ad?iu\x3d701/wpni.clientmarketing/allstatereengage111316click\x26sz\x3d1x1\x26c\x3d"+axel;else trackingPixel.src="https://pubads.g.doubleclick.net/gampad/ad?iu\x3d701/wpni.clientmarketing/allstatereengage111316imp\x26sz\x3d1x1\x26c\x3d"+axel;$(".re-engage-big").append(trackingPixel);
return true};if(TWP&&TWP.Features&&TWP.Features.Page&&TWP.Features.Page.ReEngage&&TWP.Features.Page.ReEngage.enable)enableReEngage()})(window,jQuery,TWP);(function($){})(jQuery);
(function($,window){var svi="NA";var gdpr="NA";try{var sviFull=document.cookie.match(/s_vi=([^;]+)/)?RegExp.$1:false;if(sviFull&&sviFull!==""){svi=sviFull.replace(/.*\|/,"").replace(/\[.*/,"").split("-");svi=svi[0]+"-"+svi[1]}}catch(e){}try{gdpr=document.cookie.match(/wp_gdpr=([^;]+)/)?RegExp.$1:"NA"}catch(e){}var wapoId=document.cookie.match(/wapo_login_id=([^;]+)/)?RegExp.$1:"NA";function saveKeyValue(key,value){try{var segments=localStorage.getItem("usersegmentsAdops")||"{}";segments=JSON.parse(segments);
segments[key]=value;localStorage.setItem("usersegmentsAdops",JSON.stringify(segments))}catch(e){}}function setAdopsData(data){var value=null;if(data&&data.segmentsFlag){value=data.segmentsFlag["7978704408"];if(value=="8936"){saveKeyValue("8936",1);saveKeyValue("9868",0);saveKeyValue("6136",0)}else if(value=="9868"){saveKeyValue("8936",0);saveKeyValue("9868",1);saveKeyValue("6136",0)}else if(value=="6136"){saveKeyValue("8936",0);saveKeyValue("9868",0);saveKeyValue("6136",1)}else{saveKeyValue("8936",
0);saveKeyValue("9868",0);saveKeyValue("6136",0)}value=data.segmentsFlag["5497328667"];if(value=="7204"){saveKeyValue("7204",1);saveKeyValue("0862",0);saveKeyValue("2467",0);saveKeyValue("0668",0)}else if(value=="0862"){saveKeyValue("7204",0);saveKeyValue("0862",1);saveKeyValue("2467",0);saveKeyValue("0668",0)}else if(value=="2467"){saveKeyValue("7204",0);saveKeyValue("0862",0);saveKeyValue("2467",1);saveKeyValue("0668",0)}else{saveKeyValue("7204",0);saveKeyValue("0862",0);saveKeyValue("2467",0);
saveKeyValue("0668",1)}value=data.segmentsFlag["1620826133"];if(value)saveKeyValue("1620",1);else saveKeyValue("1620",0);var segments=["808","809","810"];var thresholds=["H","M","L"];for(var is=0;is<segments.length;is++)for(var it=0;it<thresholds.length;it++){value=data.segmentsFlag["9013442"+segments[is]];if(value&&value.toUpperCase()==thresholds[it])saveKeyValue(segments[is]+"_"+thresholds[it],1);else saveKeyValue(segments[is]+"_"+thresholds[it],0)}var newsletters=["6362","3552","3433","7543","8636",
"5723","2748","3522","5263"];var list=[];value=data.segmentsFlag["1599213719"];if(value&&value.length>0)list=value.split(",");for(var i=0;i<newsletters.length;i++){var nl=newsletters[i];if(list.indexOf(nl)>-1)saveKeyValue(nl,1);else saveKeyValue(nl,0)}}}function getUserSegments(){var update=true;try{var segments=JSON.parse(localStorage.getItem("usersegments"));var updatedAt=(new Date(segments.updated)).getTime();if(Date.now()-updatedAt<3600*1E3)update=false}catch(e){}if(update)$.ajax("https://usersegment.wpdigital.net/usersegments",
{type:"POST",dataType:"json",processData:false,contentType:"application/json",data:JSON.stringify({userid:svi})}).done(function(data){setAdopsData(data);data.updated=new Date;localStorage.setItem("usersegments",JSON.stringify(data))})}function normalizeURL(url,removeTrailingSlash){var str=(url||"").trim();str=str.replace(/^(https?:)?\/\//,"");str=str.replace(/[?#].*/,"");if(removeTrailingSlash)str=str.replace(/\/$/,"");return str}function extractQueryParam(param){var rgx=new RegExp(".*[?\x26]"+param+
"\x3d([^\x26]+).*");if(rgx.test(document.location.toString()))return document.location.toString().replace(rgx,"$1");else return""}function callTargeting(){var meta=window["wp_meta_data"];var auxiliaries=meta&&meta.clavis&&meta.clavis.auxiliaries||[];var canonicalUrl=$('link[rel\x3d"canonical"]').attr("href");if(!canonicalUrl)canonicalUrl=[window.location.host,window.location.pathname].join("");var loxodoId="NA";try{loxodoId=localStorage.getItem("wp_vi")||"NA"}catch(e){}var contentType="";try{contentType=
TWP.Data.Tracking.props.content_type}catch(e){}var usersegments=null;try{usersegments=JSON.parse(localStorage.getItem("usersegments"))}catch(e){}var metadata=window.wp_meta_data||null;if(metadata){metadata=JSON.parse(JSON.stringify(metadata));var ctype=metadata["contentType"];if(ctype==""||ctype===null||ctype===false||typeof ctype=="undefined")metadata["contentType"]=[];else metadata["contentType"]=[].concat(ctype)}var dataPayload={articleid:normalizeURL(canonicalUrl,true),referrer:normalizeURL(document.referrer),
uuid:svi,userid:loxodoId,wapo_login_id:wapoId,auxiliaries:auxiliaries,contentType:contentType,wp_meta_data:metadata,usersegments:usersegments,tid:extractQueryParam("tid"),wpisrc:extractQueryParam("wpisrc"),isMobile:window.isMobile&&window.isMobile.any(),gdpr:gdpr};$.ajax({url:"https://targeting.washpost.nile.works/TargetingWebAPP/targeting",type:"POST",contentType:"application/json",dataType:"JSON",data:JSON.stringify(dataPayload)}).done(function(response){var auxMap=response.aux_map&&response.aux_map.join(",");
if(auxMap)localStorage.setItem("targeting_aux_map",auxMap);else localStorage.setItem("targeting_aux_map","")})}if(wp_pb.StaticMethods.isPageHydrated()){getUserSegments();callTargeting()}var shambleEvent=window.__e;shambleEvent.push(["shamble",function(){getUserSegments();callTargeting()}])})(jQuery,window);
(function magnetAnonymous(window,$,wp_pb){var SCROLL_INTERVAL=200;var DEFAULT_DEBOUNCE=100;var UP_OFFSET=-175;var DOWN_OFFSET=45;var WINDOW_TOP_OFFSET=0;var SCREEN_BOTTOM_OFFSET=600;logMagnetTag();$(function(){var $w=$(window);var $d=$(document);var $r=$("html");var $h=$(".pb-f-page-header-v2");var $instance=$(".pb-f-page-magnet");$instance.each(function(){var $el=$(this);$el.insertAfter($h);init($el)});function init($container){var $modulearea=$container.find(".pb-module-area");var $isMobile=$("html").hasClass("mobile");
if($isMobile)makeTitle().insertBefore(".pb-f-page-magnet").addClass("mb-title");else{makeTitle().insertAfter(".pb-magnet-controls").addClass("desk-title");$(".desk-title").addClass("showInlineBlock")}var $ctrl={};$ctrl.$container=$container.find(".pb-magnet-controls");$ctrl.$mvleft=$ctrl.$container.find(".pb-magnet-mvleft");$ctrl.$mvright=$ctrl.$container.find(".pb-magnet-mvright");$container.data("magnetControl",$ctrl);var $title=$modulearea.find(".pb-magnet-title");applyTitleCase($title.find(".pb-magnet-h2.magnet-title-case"));
$modulearea.find('[data-pb-magnet-first\x3d"true"]').insertAfter($title);var $items=$container.find(".pb-magnet-item");var $imgs=$items.find(".pb-magnet-article-image");if($items.length==0)return;var tagname=$modulearea.data("tag");var omniParams=params($modulearea.data("omni"));tagLinks(omniParams);attachNavEvents();$modulearea.css("display","");function attachNavEvents(){applyLazyload();var edown="mousedown.magnet";if(!touchDevice()){containerScroll(function(){applyNavVisibility()});$ctrl.$mvleft.off(edown).on(edown,
function(){var value=Math.max(0,$container.scrollLeft()-computeWidth());moveScroll(value)});$ctrl.$mvright.off(edown).on(edown,function(){var value=$container.scrollLeft()+computeWidth();moveScroll(value)});registerOnce("nav","start_open",debounce(function(){down()},DEFAULT_DEBOUNCE,true))}else windowTop(function(){if(WINDOW_TOP_OFFSET>=$w.scrollTop())down()});registerOnce("nav","start_close",debounce(function(){up()},DEFAULT_DEBOUNCE,true));registerOnce("magnet","start_open",debounce(function(){if(tagname&&
!!window.s)s.sendDataToOmniture("magnet_open","",{prop72:tagname})},DEFAULT_DEBOUNCE,true));function computeWidth(){var winwidth=$w.width();var itemwidth=$items.first().width();return Math.floor(winwidth/itemwidth)*itemwidth}}function params(value){var params=value?value.split("\x26"):[value];var result=[];if(params.length>0)$.each(params,function(index,value){var param=value.split("\x3d");result.push(param)});return result}function tagLinks(params){$modulearea.find("a").each(function(){var $a=$(this);
var url=$a.attr("href");$.each(params,function(index,param){url=updateUrlParam(url,param[0],param[1])});$a.attr("href",url)})}function registerOnce(arg1,arg2,fn){var regdata=[arg1,arg2];var regname=regdata.join(":");if(!$container.data(regname))wp_pb.register(regdata[0],regdata[1],fn);$container.data(regname,true)}function applyNavVisibility(){$ctrl.scrollleft=$container.scrollLeft();$ctrl.leftoffset=$container.scrollLeft()+$container.width();var rightbound=$modulearea[0].offsetWidth-$ctrl.leftoffset<=
0;$ctrl.$mvleft.toggle(!!$ctrl.scrollleft);$ctrl.$mvright.toggle(!rightbound)}function applyLazyload(){var sename="scroll.magnet-lazy";var reveal=0;$container.off(sename).on(sename,debounce(function(){lazy()},1,true));lazy();function lazy(){var count=Math.max(reveal,computeNumberOfImages());if(!!count&&"NaN"!==count.toString()&&reveal!==count){reveal=count;$imgs.filter(":lt("+reveal+")").each(function(){var $el=$(this);$el.attr("src",$el.data("original"))})}}function computeNumberOfImages(){return Math.ceil(($container.scrollLeft()+
($container.width()||$(window).width()))/$items.first().width())}}function nearBottom(){return $w.scrollTop()>=$d.height()-$w.height()-SCREEN_BOTTOM_OFFSET}function down(){$r.addClass("magnet");$(".mb-title").addClass("showBlock");if(!nearBottom())$r.addClass("magnet-nudge");if(touchDevice()){$container.add(".mb-title").addClass("magnet-open");$container.css("position","fixed !important")}else{$container.addClass("magnet-open").css({top:DOWN_OFFSET});$container.css("position","fixed")}wp_pb.report("magnet",
"start_open")}function up(){$r.removeClass("magnet magnet-nudge");$(".mb-title").removeClass("showBlock");if(touchDevice())$container.add(".mb-title").removeClass("magnet-open");else $container.removeClass("magnet-open").css({top:UP_OFFSET});wp_pb.report("magnet","start_close")}function containerScroll(fn){var scroll;var rename="resize.magnet";$w.off(rename).on(rename,function(){scroll=true});var sename="scroll.magnet";$container.off(sename).on(sename,function(){scroll=true});var tid;setInterval(function(){if(scroll){if(tid)clearTimeout(tid);
tid=setTimeout(function(){fn()},SCROLL_INTERVAL)}scroll=false},SCROLL_INTERVAL)}function getTitleHtml(){return $("#PageMagnetTitle").html()}function makeTitle(){return $(getTitleHtml())}function windowTop(fn){var atop=false;var tid;var sename="scroll.magnet";$w.off(sename).on(sename,function(){var top=$(window).scrollTop();if(!atop&&top==0){atop=true;if(tid)clearTimeout(tid);tid=setTimeout(function(){fn()},SCROLL_INTERVAL)}else if(top>=0)atop=false})}function moveScroll(value){$container.stop().animate({scrollLeft:value},
"slow")}}function touchDevice(){return $r.hasClass("touch")}});function titleCase(strValue){var str=strValue.replace(/([^\W_]+[^\s-]*) */g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()});var lowers=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"];var i,j;for(i=0,j=lowers.length;i<j;i++)str=str.replace(new RegExp("\\s"+lowers[i]+"\\s","g"),function(txt){return txt.toLowerCase()});var uppers=["Id",
"Tv"];for(i=0,j=uppers.length;i<j;i++)str=str.replace(new RegExp("\\b"+uppers[i]+"\\b","g"),uppers[i].toUpperCase());return str}function applyTitleCase($el){var title=titleCase(($el.text()||"").replace(/_/gi," "));$el.text(title)}function updateUrlParam(url,key,value){var n=new RegExp("([?\x26])"+key+"\x3d.*?(\x26|$)","i");var i=-1!==url.indexOf("?")?"\x26":"?";return url.match(n)?url.replace(n,"$1"+key+"\x3d"+value+"$2"):url+i+key+"\x3d"+value}function logMagnetTag(){var tagname;var modulearea=document.getElementsByClassName("pb-f-page-magnet")[0].getElementsByClassName("pb-module-area")[0];
tagname=modulearea&&modulearea.getAttribute("data-tag");if(tagname&&!!window.s)s.prop55=tagname}function debounce(func,wait,immediate){var timeout;return function(){var context=this,args=arguments;var later=function(){timeout=null;if(!immediate)func.apply(context,args)};var callNow=immediate&&!timeout;clearTimeout(timeout);timeout=setTimeout(later,wait);if(callNow)func.apply(context,args)}}})(window,jQuery,wp_pb);__darwinmeta__=window.__darwinmeta__||{isFired:false};
(function(window,store){var MAX_WAIT=200;_dw=window._dw||[];_dw.push(["global","ready",function(api){if(!store.isFired){store.isFired=true;fireEvent(api)}}]);setTimeout(function(){if(!store.isFired&&"function"==typeof window._dw)_dw.push(["global","ready",function(api){store.isFired=true;fireEvent(api)}])},MAX_WAIT);function fireEvent(api){$(window.document).trigger("abtest-ready",[api])}})(window,__darwinmeta__);
(function(){var wp_data=window.wp_meta_data;var article=null;var host="https://contextual-linking-public-prod.washpost.nile.works/api/v1/";var locale=document.location.toString();if(window.wp_pb.environment!=="production")host=host.replace(/prod/,"test");var supportsPassive=false;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=true}});window.addEventListener("test",null,opts)}catch(e){}var visibilityCallbacks={};function visibilityCallback(){var config=null;var element=
null;var callback=null;var body=document.body;var html=document.documentElement;var height=html.clientHeight||body.clientHeight;for(var key in visibilityCallbacks)if(visibilityCallbacks.hasOwnProperty(key)){config=visibilityCallbacks[key];if(config){element=config[0];callback=config[1];var boundaries=element.getBoundingClientRect();if(boundaries.top>0&&boundaries.top<height){callback();visibilityCallbacks[key]=null}}}}window.addEventListener("resize",visibilityCallback,supportsPassive?{passive:true}:
false);document.addEventListener("scroll",visibilityCallback,supportsPassive?{passive:true}:false);var links={init:function(){var self=this;if(wp_data&&wp_data.contextualLinking&&wp_data.contextualLinking.matches&&wp_data.contextualLinking.matches.result)self.processAll(wp_data.contextualLinking.matches.result.matches)},processAll:function(data){var self=this;article=data;var links=[];var results=article||[];var url=locale.split("?")[0];if(results)for(var key in results)if(results.hasOwnProperty(key))links.push(results[key]);
for(var i=0;i<links.length;i++)try{if(links[i].concept__note_uuid==null&&links[i].concept__note_question_uuid==null&&links[i].approval_status&&(links[i].approval_status=="pending"||links[i].approval_status=="approved")&&links[i].deleted_at===null&&links[i].concept__concept_url!==url)self.processOne(links[i])}catch(e){}},processOne:function(link){var self=this;var found=false;var articleLinks=document.querySelector("article").getElementsByTagName("a");for(var i=0;i<articleLinks.length;i++){var href1=
(articleLinks[i].href||"").replace(/[?#].*/,"");var href2=link.concept__concept_url.replace(/[?#].*/,"");if(href1==href2)found=true}if(!found){var articlePars=document.querySelector("article").getElementsByTagName("p");for(var p=0;p<articlePars.length;p++)self.addLink(articlePars[p],link)}},addLink:function(elem,link){var self=this;var val;if(link.found)return true;for(var i=0;i<elem.childNodes.length;i++){var node=elem.childNodes[i];if(node.nodeType==Node.TEXT_NODE){if(self.isMatch(node,link)){self.replaceTextWithLink(node,
link);link.found=true}}else if(node.nodeType==Node.ELEMENT_NODE)if(node.nodeName.toLowerCase()!="a"){val=self.addLink(node,link);if(val)return true}else;}},replaceTextWithLink:function(textNode,link){var match=this.getRegex(link).exec(textNode.textContent);if(match[1].length>0)textNode=textNode.splitText(match[1].length);if(textNode.textContent.length==link.matched_keyword.length);else textNode.splitText(link.matched_keyword.length);var newNode=document.createElement("a");newNode.setAttribute("href",
link.concept__concept_url+"?tid\x3da_inl_auto");newNode.setAttribute("target","_blank");newNode.setAttribute("class","contextual-link");newNode.textContent=textNode.textContent;var parent=textNode.parentNode;parent.replaceChild(newNode,textNode);var that=this;visibilityCallbacks[link.id]=[newNode,function(){that.serveLink(link)}];visibilityCallback();this.trackClick(newNode,link)},isMatch:function(node,link){var t1=node.textContent.replace(/[^a-z]/gi,"").trim();var t2=link.matched_text_block.replace(/[^a-z]/gi,
"").trim();if(t1.substr(0,50)==t2.substr(0,50))return true;return false},getRegex:function(link){return new RegExp("(.*?)("+link.matched_keyword+")(.*)","i")},trackClick:function(elem,link){elem.addEventListener("click",function(){var cReq=new XMLHttpRequest;cReq.open("POST",host+"matches/"+link.id+"/clicked/",true);cReq.responseType="json";cReq.setRequestHeader("Arc-Organization","washpost");cReq.send()},false)},serveLink:function(link){var sReq=new XMLHttpRequest;sReq.open("POST",host+"matches/"+
link.id+"/served/",true);sReq.responseType="json";sReq.setRequestHeader("Arc-Organization","washpost");sReq.send()}};if(wp_pb.StaticMethods.isPageHydrated())links.init();var shambleEvent=window.__e;shambleEvent.push(["shamble",function(){links.init()}]);return links})();